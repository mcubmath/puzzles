{"version":3,"sources":["login/user-context.js","login/index.js","puzzles/calcudoku/instructions.js","api-utils.js","puzzles/calcudoku/instance.js","puzzles/calcudoku/index.js","puzzles/logic/instance.js","puzzles/logic/index.js","puzzles/light/instance.js","puzzles/light/instructions.js","puzzles/light/instance-list.js","puzzles/light/index.js","puzzles/vector-logic.js","puzzles/matchstick/canvas.js","puzzles/matchstick/instance.js","puzzles/matchstick/instructions.js","puzzles/matchstick/index.js","puzzles/tangram/model.js","puzzles/tangram/view.js","puzzles/tangram/controller.js","puzzles/tangram/instance.js","puzzles/tangram/sample-data.js","puzzles/tangram/instructions.js","puzzles/tangram/index.js","puzzles/index.js","home/index.js","puzzles/instance-list.js","puzzles/instance-router.js","index.js"],"names":["UserContext","React","createContext","user","setUser","Login","props","useState","first","setFirst","last","setLast","fetching","setFetching","badLogin","setBadLogin","useContext","updateName","updater","event","name","newName","target","value","replace","length","login","useCallback","create","a","studentData","uri","process","fetch","method","headers","body","JSON","stringify","response","ok","json","token","jwt","decode","student","sessionStorage","setItem","history","push","console","log","status","downHandler","key","useEffect","window","addEventListener","removeEventListener","className","htmlFor","type","id","onChange","bind","onClick","parsedOperations","example1","size","work","Array","fill","map","i","row","Math","floor","col","cages","example2","squares","operation","result","example3","values","Instructions","data","Instance","puzzleData","index","matchSquare","squareMatcher","entry","find","cage","neighbors","neighborList","isTopLeft","every","square","generateGrid","grid","activeSquare","setActiveSquare","classList","join","disabled","directions","Object","keys","dir","useUpdateActivePuzzle","puzzleName","puzzleId","apiurl","authorization","useUpdateCompleted","checkComplete","sessionDataKey","sessionData","parse","getItem","completed","useUpdateWork","setSaveStatus","newSessionData","workPosition","fetchUserData","url","puzzle","instanceKey","setGrid","saveStatus","updateWork","hasCageError","reduce","acc","hasError","hasDuplicate","isDuplicate","workUpdater","sq","isNaN","includes","renderNumberSelect","number","match","some","reducer","startVal","gridValues","val","b","gridvals","ListPreview","instanceList","instance","title","description","setWork","updateTimer","setUpdateTimer","initializing","useRef","current","clearHistoryListener","listen","setTimeout","clearTimeout","conditionalUpdater","timeInterval","setInterval","timer","clearInterval","e","placeholder","fetchCompletionStatus","setWorkPosition","cols","rows","beginstate","neighborType","isActive","slice","filter","triggerSquare","updatedWork","renderSquare","jumpTo","position","JumpBack","jump","isactive","StepBack","step","max","StepForward","min","JumpForward","xmlns","width","height","viewBox","toString","d","example4","showNav","InstructionsX","activatedNeighbors","from","forEach","setCurrent","path","render","orthogonalVector","vector","x","y","distanceFromSegment","point","initial","terminal","orthogonal","initialLine","sum","terminalLine","distanceFromLine","distanceFromPoint","pointA","pointB","magnitude","difference","lineVector","pointVector","abs","vectorA","vectorB","scalarProduct","scalar","sqrt","dotProduct","vector1","vector2","Canvas","canvasRef","sticks","setSticks","selectionProximity","startingConfiguration","stickLength","stickWidth","activePoint","setActivePoint","activeStick","setActiveStick","mouseLoc","setMouseLoc","getMouseLoc","locationObject","rect","getBoundingClientRect","mouseLocation","clientX","left","clientY","top","getPointSelection","flatMap","stick","distance","accDistance","Infinity","getStickSelection","selectPoint","selectedPoint","selectedStick","selectStick","pointDrag","adjustedVector","clearSelection","upHandler","draw","ctx","clearRect","beginPath","lineWidth","lineCap","stroke","strokeStyle","moveTo","lineTo","pointSelection","arc","PI","fillStyle","shadowBlur","shadowColor","stickSelection","context","getContext","preventScroll","preventDefault","document","passive","ref","onTouchStart","touch","touches","touchLocation","onTouchEnd","onTouchMove","stickReference","adjustment","touchStickDrag","onMouseDown","onMouseUp","onMouseLeave","onMouseMove","movementX","movementY","mouseStickDrag","newWork","Reset","reset","resetWork","endpoint","demoData","createTangrams","unitLength","startingCenter","positions","largeTriangle1","center","sin","angle","largeTriangle2","mediumTriangle","parallelogram","smallTriangle1","smallTriangle2","createTriangle","color","createSquare","createParallelogram","createVertex","shape","relAngle","distanceFromCenter","vertex","defineProperty","get","cos","distanceToClosePoint","distanceToFarPoint","triangle","vertices","_","atan2","objective","shapes","vertexSelection","shapeSelection","objectiveCenter","drawObjective","drawShape","firstVertex","closePath","adjustedObjective","objectiveStart","objectivePoints","Controller","useMemo","activeVertex","setActiveVertex","activeShape","setActiveShape","setShapes","getVertexSelection","points","getShapeSelection","adjacentVertex","segment","point1","point2","onSameSide","isInsideShape","select","selectedShape","vertexIndex","indexOf","relVertex","fixedRelVertex","relVector","startVector","angleDifference","relMouse","mouseAngle","snapAngle","snappedAngle","snapShape","canvas","querySelector","startingPosition","mouseShapeDrag","touchShapeDrag","defaultData","puzzleList","logic","calcudoku","light","matchstick","tangram","potd","Home","POTD","renderPuzzleListing","POTDPreview","List","puzzleType","completionStatusFetched","setCompletionStatusFetched","style","ceil","string","char","toUpperCase","InstanceRouter","exact","createBrowserHistory","backArrowPath","Routes","sessionUser","defaultContext","basename","Provider","ProfileBar","component","BackButton","renderPuzzleRoute","to","prevURL","location","href","capitalize","removeItem","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.2dd32d2c.chunk.js","sourcesContent":["import React from \"react\";\n\nexport const UserContext = React.createContext({\n\tuser: null,\n\tsetUser: () => {},\n});\n","import React, { useState, useContext, useEffect, useCallback } from \"react\";\nimport jwt from \"jsonwebtoken\";\nimport { UserContext } from \"./user-context\";\n\nexport default function Login(props) {\n\tconst [first, setFirst] = useState();\n\tconst [last, setLast] = useState();\n\tconst [fetching, setFetching] = useState(false);\n\tconst [badLogin, setBadLogin] = useState(false);\n\tconst { setUser } = useContext(UserContext);\n\n\tconst updateName = (updater, event) => {\n\t\tupdater((name) => {\n\t\t\tconst newName = event.target.value.replace(/[^a-zA-Z\\-']/, \"\");\n\t\t\treturn newName.length < 20 ? newName : name;\n\t\t});\n\t};\n\n\tconst login = useCallback(\n\t\tasync (create) => {\n\t\t\tif (!(first && last)) {\n\t\t\t\tsetBadLogin(\"missing name\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsetFetching(create ? \"create\" : \"login\");\n\t\t\tconst studentData = { first, last };\n\t\t\tconst uri =\n\t\t\t\t`${process.env.REACT_APP_API_URL}/students` +\n\t\t\t\t(create ? \"\" : \"/login\");\n\t\t\ttry {\n\t\t\t\tconst response = await fetch(uri, {\n\t\t\t\t\tmethod: \"POST\",\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t\t},\n\t\t\t\t\tbody: JSON.stringify(studentData),\n\t\t\t\t});\n\t\t\t\tsetFetching(false);\n\t\t\t\tif (response.ok) {\n\t\t\t\t\tsetBadLogin(false);\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst token = (await response.json()).token;\n\t\t\t\t\t\tconst { student } = jwt.decode(token);\n\t\t\t\t\t\tconst user = { token, student };\n\t\t\t\t\t\tsessionStorage.setItem(\n\t\t\t\t\t\t\t\"mcub-student-user\",\n\t\t\t\t\t\t\tJSON.stringify(user)\n\t\t\t\t\t\t);\n\t\t\t\t\t\tsetUser(user);\n\t\t\t\t\t\tprops.history.push(\"/\");\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tconsole.log(error);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tsetBadLogin(response.status);\n\t\t\t\t\tconsole.log(\"HTTP error, status = \" + response.status);\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tsetFetching(false);\n\t\t\t\tsetBadLogin(500);\n\t\t\t\tconsole.log(error);\n\t\t\t}\n\t\t},\n\t\t[first, last, props.history, setUser]\n\t);\n\n\tconst downHandler = useCallback(\n\t\t({ key }) => {\n\t\t\tif (key === \"Enter\") {\n\t\t\t\tlogin(false);\n\t\t\t}\n\t\t},\n\t\t[login]\n\t);\n\n\tuseEffect(() => {\n\t\twindow.addEventListener(\"keydown\", downHandler);\n\t\treturn () => window.removeEventListener(\"keydown\", downHandler);\n\t}, [downHandler]);\n\n\treturn (\n\t\t<div className=\"login-container\">\n\t\t\t<div className=\"login-window\">\n\t\t\t\t{fetching ? (\n\t\t\t\t\t<div className=\"fetching-indicator\">\n\t\t\t\t\t\t{fetching === \"create\"\n\t\t\t\t\t\t\t? \"Creating new user...\"\n\t\t\t\t\t\t\t: \"Logging in...\"}\n\t\t\t\t\t</div>\n\t\t\t\t) : null}\n\t\t\t\t{badLogin ? (\n\t\t\t\t\t<p className=\"login-error\">\n\t\t\t\t\t\t{badLogin === 404\n\t\t\t\t\t\t\t? \"User not found. Please try again or create a new user.\"\n\t\t\t\t\t\t\t: badLogin === 403\n\t\t\t\t\t\t\t? \"User already exists.\"\n\t\t\t\t\t\t\t: badLogin === \"missing name\"\n\t\t\t\t\t\t\t? \"Please enter both your first and last name.\"\n\t\t\t\t\t\t\t: \"An error occurred, please try again.\"}\n\t\t\t\t\t</p>\n\t\t\t\t) : null}\n\t\t\t\t<div className=\"name-container first\">\n\t\t\t\t\t<label htmlFor=\"firstname\">First Name:</label>\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tname=\"firstname\"\n\t\t\t\t\t\tid=\"firstname\"\n\t\t\t\t\t\tvalue={first}\n\t\t\t\t\t\tonChange={updateName.bind(null, setFirst)}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"name-container last\">\n\t\t\t\t\t<label htmlFor=\"lastname\">Last Name:</label>\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tname=\"lastname\"\n\t\t\t\t\t\tid=\"lastname\"\n\t\t\t\t\t\tvalue={last}\n\t\t\t\t\t\tonChange={updateName.bind(null, setLast)}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<button className=\"create-student\" onClick={() => login(true)}>\n\t\t\t\t\tCreate\n\t\t\t\t</button>\n\t\t\t\t<button className=\"login-student\" onClick={() => login(false)}>\n\t\t\t\t\tLog-In\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n","import React, { useState } from \"react\";\n\nconst parsedOperations = {\n\t\"-\": \"-\",\n\t\"+\": \"+\",\n\t\"*\": \"x\",\n\t\"/\": \"÷\",\n};\n\nconst example1 = {\n\tsize: 4,\n\twork: Array(16)\n\t\t.fill(null)\n\t\t.map((...[, i]) => {\n\t\t\tconst row = Math.floor(i / 4);\n\t\t\tconst col = i % 4;\n\t\t\tconst value = ((col + row) % 4) + 1;\n\t\t\treturn { row, col, value };\n\t\t}),\n\tcages: [],\n};\nconst example2 = {\n\tsize: 4,\n\twork: [\n\t\t{ col: 0, row: 0, value: 1 },\n\t\t{ col: 1, row: 0, value: 2 },\n\t\t{ col: 2, row: 0, value: 3 },\n\t\t{ col: 3, row: 0, value: 4 },\n\t\t{ col: 0, row: 2, value: 2 },\n\t\t{ col: 0, row: 3, value: 4 },\n\t\t{ col: 1, row: 3, value: 1 },\n\t\t{ col: 3, row: 3, value: 3 },\n\t\t{ col: 2, row: 1, value: 2 },\n\t\t{ col: 2, row: 2, value: 4 },\n\t],\n\tcages: [\n\t\t{\n\t\t\tsquares: [\n\t\t\t\t{ col: 0, row: 0 },\n\t\t\t\t{ col: 1, row: 0 },\n\t\t\t],\n\t\t\toperation: \"+\",\n\t\t\tresult: \"3\",\n\t\t},\n\t\t{\n\t\t\tsquares: [\n\t\t\t\t{ col: 2, row: 0 },\n\t\t\t\t{ col: 3, row: 0 },\n\t\t\t],\n\t\t\toperation: \"-\",\n\t\t\tresult: \"1\",\n\t\t},\n\t\t{ squares: [{ col: 3, row: 3 }], operation: \"\", result: \"3\" },\n\t\t{\n\t\t\tsquares: [\n\t\t\t\t{ col: 0, row: 2 },\n\t\t\t\t{ col: 0, row: 3 },\n\t\t\t\t{ col: 1, row: 3 },\n\t\t\t],\n\t\t\toperation: \"*\",\n\t\t\tresult: \"8\",\n\t\t},\n\t\t{\n\t\t\tsquares: [\n\t\t\t\t{ col: 2, row: 1 },\n\t\t\t\t{ col: 2, row: 2 },\n\t\t\t],\n\t\t\toperation: \"/\",\n\t\t\tresult: \"2\",\n\t\t},\n\t],\n};\nconst example3 = {\n\tsize: 4,\n\twork: Array(16)\n\t\t.fill(null)\n\t\t.map((...[, i]) => {\n\t\t\tconst values = [3, 2, 4, 1, 2, 1, 3, 4, 4, 3, 1, 2, 1, 4, 2, 3];\n\t\t\tconst row = Math.floor(i / 4);\n\t\t\tconst col = i % 4;\n\t\t\tconst value = values[i];\n\t\t\treturn { row, col, value };\n\t\t}),\n\tcages: [\n\t\t{\n\t\t\tsquares: [\n\t\t\t\t{ col: 0, row: 0 },\n\t\t\t\t{ col: 0, row: 1 },\n\t\t\t],\n\t\t\toperation: \"+\",\n\t\t\tresult: \"5\",\n\t\t},\n\t\t{\n\t\t\tsquares: [\n\t\t\t\t{ col: 0, row: 2 },\n\t\t\t\t{ col: 0, row: 3 },\n\t\t\t\t{ col: 1, row: 3 },\n\t\t\t],\n\t\t\toperation: \"+\",\n\t\t\tresult: \"9\",\n\t\t},\n\t\t{\n\t\t\tsquares: [\n\t\t\t\t{ col: 1, row: 0 },\n\t\t\t\t{ col: 1, row: 1 },\n\t\t\t\t{ col: 2, row: 0 },\n\t\t\t],\n\t\t\toperation: \"-\",\n\t\t\tresult: \"1\",\n\t\t},\n\t\t{\n\t\t\tsquares: [\n\t\t\t\t{ col: 1, row: 2 },\n\t\t\t\t{ col: 2, row: 2 },\n\t\t\t],\n\t\t\toperation: \"+\",\n\t\t\tresult: \"4\",\n\t\t},\n\t\t{\n\t\t\tsquares: [\n\t\t\t\t{ col: 2, row: 1 },\n\t\t\t\t{ col: 3, row: 0 },\n\t\t\t\t{ col: 3, row: 1 },\n\t\t\t],\n\t\t\toperation: \"-\",\n\t\t\tresult: \"0\",\n\t\t},\n\t\t{\n\t\t\tsquares: [\n\t\t\t\t{ col: 2, row: 3 },\n\t\t\t\t{ col: 3, row: 2 },\n\t\t\t\t{ col: 3, row: 3 },\n\t\t\t],\n\t\t\toperation: \"+\",\n\t\t\tresult: \"7\",\n\t\t},\n\t],\n};\n\nexport default function Instructions({ history }) {\n\treturn (\n\t\t<div className=\"calcudoku-instructions\">\n\t\t\t<h2>\n\t\t\t\tCalcudoku Instructions\n\t\t\t\t<hr />\n\t\t\t</h2>\n\n\t\t\t<p>\n\t\t\t\tThe goal of each puzzle is to fill the grid using only certain\n\t\t\t\tdigits –– 1 through 4 for a 4×4 grid, 1 through 5 for a 5×5,\n\t\t\t\tetc. –– so that no digit appears more than once in any row or\n\t\t\t\tany column.\n\t\t\t</p>\n\t\t\t<Instance data={example1} />\n\t\t\t<p>\n\t\t\t\tAdditionally, the grid is divided into heavily outlined groups\n\t\t\t\tof squares called “cages”. Each cage has a target number and an\n\t\t\t\toperation in its upper left corner. The numbers when the numbers\n\t\t\t\tin the cage are combined using the cage’s operation they must\n\t\t\t\tequal the target number.\n\t\t\t</p>\n\t\t\t<Instance data={example2} />\n\t\t\t<p>\n\t\t\t\tDigits may be repeated within a cage, as long as they are not in\n\t\t\t\tthe same row or column. No operation is relevant for a\n\t\t\t\tsingle-cell cage: placing the \"target\" in the cell is the only\n\t\t\t\tpossibility.\n\t\t\t</p>\n\t\t\t<Instance data={example3} />\n\t\t\t<p>\n\t\t\t\tBe careful that you know for sure that a number{\" \"}\n\t\t\t\t<strong>has</strong> to go in a square before you put it there.\n\t\t\t\tMaking a mistake early can cause trouble later on. Use lots of\n\t\t\t\tprocess of elimination!\n\t\t\t</p>\n\t\t\t<button\n\t\t\t\tclassName=\"try-it\"\n\t\t\t\tonClick={() => history.push(\"/calcudoku\")}\n\t\t\t>\n\t\t\t\tTry It!\n\t\t\t</button>\n\t\t</div>\n\t);\n}\n\nfunction Instance({ data }) {\n\tconst { size } = data;\n\tconst [grid, setGrid] = useState(generateGrid(data));\n\tconst [activeSquare, setActiveSquare] = useState(null);\n\n\tconst renderSquare = (square) => {\n\t\tconst classList =\n\t\t\t\"calcudoku-square \" +\n\t\t\tsquare.neighbors.join(\" \") +\n\t\t\t(square === activeSquare ? \" active\" : \"\");\n\t\treturn (\n\t\t\t<div className={classList} onClick={() => setActiveSquare(square)}>\n\t\t\t\t<div className=\"cage-indicator\">\n\t\t\t\t\t{square.result}\n\t\t\t\t\t{square.operation}\n\t\t\t\t</div>\n\t\t\t\t<input type=\"number\" value={square.value || \"\"} disabled />\n\t\t\t</div>\n\t\t);\n\t};\n\n\tconst renderNumberSelect = (number) => {\n\t\treturn (\n\t\t\t<button\n\t\t\t\tclassName=\"number-select\"\n\t\t\t\tkey={`num${number}`}\n\t\t\t\tonClick={() => {\n\t\t\t\t\tactiveSquare.value = number;\n\t\t\t\t\tsetGrid([...grid]);\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{number}\n\t\t\t</button>\n\t\t);\n\t};\n\n\treturn (\n\t\t<div>\n\t\t\t{grid ? (\n\t\t\t\t<div className=\"puzzle-container instructions\" size={size}>\n\t\t\t\t\t<div className=\"grid-container\" size={size}>\n\t\t\t\t\t\t{grid.map(renderSquare)}\n\t\t\t\t\t</div>\n\t\t\t\t\t{/*\n\t\t\t\t\t<div className=\"number-select-container\">\n\t\t\t\t\t\t{new Array(size)\n\t\t\t\t\t\t\t.fill(null)\n\t\t\t\t\t\t\t.map((...[, number]) =>\n\t\t\t\t\t\t\t\trenderNumberSelect(number + 1)\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t</div>*/}\n\t\t\t\t</div>\n\t\t\t) : null}\n\t\t</div>\n\t);\n}\n\nfunction generateGrid(puzzleData) {\n\tconst { size, cages, work } = puzzleData;\n\tconst squares = Array(size ** 2).fill(null);\n\treturn squares.map((...[, index]) => {\n\t\tconst col = Math.floor(index / size);\n\t\tconst row = index % size;\n\t\tconst matchSquare = squareMatcher({ col, row });\n\t\tconst entry = work.find(matchSquare);\n\t\tconst value = entry ? entry.value : null;\n\t\tconst cage = cages.find((cage) => cage.squares.find(matchSquare));\n\t\tconst neighbors = neighborList({ col, row }, cage);\n\t\tif (!cage) return { col, row, value, neighbors };\n\t\tconst isTopLeft = cage.squares.every(\n\t\t\t(square) =>\n\t\t\t\tsquare.col >= col && (square.row >= row || square.col > col)\n\t\t);\n\t\tconst result = isTopLeft ? cage.result : null;\n\t\tconst operation = isTopLeft ? parsedOperations[cage.operation] : null;\n\t\treturn { col, row, value, neighbors, result, operation };\n\t});\n}\n\nfunction neighborList(square, cage) {\n\tconst neighbors = [];\n\tconst directions = {\n\t\t\"n-up\": { col: square.col - 1, row: square.row },\n\t\t\"n-down\": { col: square.col + 1, row: square.row },\n\t\t\"n-left\": { col: square.col, row: square.row - 1 },\n\t\t\"n-right\": { col: square.col, row: square.row + 1 },\n\t};\n\n\tif (!cage) return Object.keys(directions);\n\n\tfor (let dir in directions) {\n\t\tconst matchSquare = squareMatcher(directions[dir]);\n\t\tif (cage.squares.find(matchSquare)) {\n\t\t\tneighbors.push(dir);\n\t\t}\n\t}\n\n\treturn neighbors;\n}\n\nfunction squareMatcher({ col, row }) {\n\treturn (square) => square.col === col && square.row === row;\n}\n","import { useContext, useEffect } from \"react\";\nimport { UserContext } from \"./login/user-context\";\n\nexport function useUpdateActivePuzzle(puzzleName, puzzleId) {\n\tconst {\n\t\tuser: { token },\n\t} = useContext(UserContext);\n\tuseEffect(() => {\n\t\tconst apiurl = `${process.env.REACT_APP_API_URL}/activepuzzle`;\n\t\t(async () => {\n\t\t\tawait fetch(apiurl, {\n\t\t\t\tmethod: \"PUT\",\n\t\t\t\theaders: {\n\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t\tauthorization: token,\n\t\t\t\t},\n\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\tpuzzleName,\n\t\t\t\t\tpuzzleId,\n\t\t\t\t}),\n\t\t\t});\n\t\t})();\n\n\t\treturn () => {\n\t\t\tfetch(apiurl, {\n\t\t\t\tmethod: \"DELETE\",\n\t\t\t\theaders: {\n\t\t\t\t\tauthorization: token,\n\t\t\t\t},\n\t\t\t});\n\t\t};\n\t}, [token, puzzleId, puzzleName]);\n}\n\nexport function useUpdateCompleted(puzzleName, puzzleId, checkComplete) {\n\tconst {\n\t\tuser: { token },\n\t} = useContext(UserContext);\n\tconst sessionDataKey = `${puzzleName}-instance-data-${puzzleId}`;\n\tconst apiurl =\n\t\t`${process.env.REACT_APP_API_URL}/puzzles/` +\n\t\t`${puzzleName}/${puzzleId}`;\n\n\tuseEffect(() => {\n\t\tconst sessionData = JSON.parse(sessionStorage.getItem(sessionDataKey));\n\t\tif (sessionData.completed) return;\n\t\telse if (checkComplete()) {\n\t\t\tfetch(`${apiurl}/completed`, {\n\t\t\t\tmethod: \"PUT\",\n\t\t\t\theaders: {\n\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t\tauthorization: token,\n\t\t\t\t},\n\t\t\t\tbody: JSON.stringify({ completed: true }),\n\t\t\t});\n\t\t\tsessionData.completed = true;\n\t\t\tsessionStorage.setItem(sessionDataKey, JSON.stringify(sessionData));\n\t\t}\n\t}, [sessionDataKey, checkComplete, apiurl, token]);\n}\n\nexport function useUpdateWork(puzzleName, puzzleId, setSaveStatus) {\n\tconst {\n\t\tuser: { token },\n\t} = useContext(UserContext);\n\tconst sessionDataKey = `${puzzleName}-instance-data-${puzzleId}`;\n\tconst apiurl =\n\t\t`${process.env.REACT_APP_API_URL}/puzzles/` +\n\t\t`${puzzleName}/${puzzleId}`;\n\treturn async (work) => {\n\t\tsetSaveStatus(\"saving\");\n\t\tconst response = await fetch(apiurl, {\n\t\t\tmethod: \"PUT\",\n\t\t\theaders: {\n\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\tauthorization: token,\n\t\t\t},\n\t\t\tbody: JSON.stringify({ puzzleData: work }),\n\t\t});\n\n\t\tconst newSessionData = JSON.parse(\n\t\t\tsessionStorage.getItem(sessionDataKey)\n\t\t);\n\t\tnewSessionData.work = work;\n\t\tnewSessionData.workPosition = work.length;\n\t\tsessionStorage.setItem(sessionDataKey, JSON.stringify(newSessionData));\n\n\t\tif (response.ok) setSaveStatus(\"saved\");\n\t\telse setSaveStatus(\"error\");\n\t};\n}\n\nexport function useFetchPuzzleData(puzzleName, puzzleId) {\n\tconst {\n\t\tuser: { token },\n\t} = useContext(UserContext);\n\tconst sessionDataKey = `${puzzleName}-instance-data-${puzzleId}`;\n\tconst apiurl =\n\t\t`${process.env.REACT_APP_API_URL}/puzzles/` +\n\t\t`${puzzleName}/${puzzleId}`;\n\treturn async () => {\n\t\tconst response = await fetch(apiurl, {\n\t\t\tmethod: \"GET\",\n\t\t\theader: { authorization: token },\n\t\t});\n\t\tif (response.ok) {\n\t\t\tconst data = await response.json();\n\t\t\tsessionStorage.setItem(sessionDataKey, JSON.stringify(data));\n\t\t} else {\n\t\t\tthrow new Error(`HTTP error, status = ${response.status}`);\n\t\t}\n\t};\n}\n\nexport async function fetchUserData({ token }) {\n\tconst url = `${process.env.REACT_APP_API_URL}/data`;\n\tconst response = await fetch(url, {\n\t\tmethod: \"GET\",\n\t\theaders: {\n\t\t\tauthorization: token,\n\t\t},\n\t});\n\tif (response.ok) {\n\t\tconst data = await response.json();\n\t\tfor (let puzzleName in data) {\n\t\t\tfor (let puzzle of data[puzzleName]) {\n\t\t\t\tconst { puzzleId } = puzzle;\n\t\t\t\tconst instanceKey = `${puzzleName}-instance-data-${puzzleId}`;\n\t\t\t\tsessionStorage.setItem(instanceKey, JSON.stringify(puzzle));\n\t\t\t}\n\t\t}\n\t} else {\n\t\tconsole.log(`HTTP error, status = ${response.status}`);\n\t}\n}","import React, { useState, useEffect, useCallback } from \"react\";\nimport {\n\tuseUpdateActivePuzzle,\n\tuseUpdateCompleted,\n\tuseUpdateWork,\n} from \"../../api-utils.js\";\n\nconst parsedOperations = {\n\t\"-\": \"-\",\n\t\"+\": \"+\",\n\t\"*\": \"x\",\n\t\"/\": \"÷\",\n};\n\nexport default function Instance({ name }) {\n\tconst sessionDataKey = `calcudoku-instance-data-${name}`;\n\tconst sessionData = JSON.parse(sessionStorage.getItem(sessionDataKey));\n\tconst { size, cages } = sessionData;\n\tconst [grid, setGrid] = useState(generateGrid(sessionData));\n\tconst [activeSquare, setActiveSquare] = useState(null);\n\tconst [saveStatus, setSaveStatus] = useState(\"saved\");\n\tconst updateWork = useUpdateWork(\"calcudoku\", name, setSaveStatus);\n\n\tconst checkComplete = useCallback(() => {\n\t\tconst hasCageError = cages.reduce(\n\t\t\t(acc, cage) => hasError(grid, cage) || acc,\n\t\t\tfalse\n\t\t);\n\t\tconst hasDuplicate = grid.reduce(\n\t\t\t(acc, square) => isDuplicate(grid, square) || acc,\n\t\t\tfalse\n\t\t);\n\n\t\treturn !hasCageError && !hasDuplicate;\n\t}, [grid, cages]);\n\t\n\tconst workUpdater = () => {\n\t\tconst work = grid.map((sq) => {\n\t\t\treturn { col: sq.col, row: sq.row, value: sq.value };\n\t\t});\n\t\tupdateWork(work);\n\t};\n\n\tconst downHandler = ({ key }) => {\n\t\tif (activeSquare) {\n\t\t\tif (!isNaN(key) && 1 <= key && key <= size) {\n\t\t\t\tactiveSquare.value = key;\n\t\t\t} else {\n\t\t\t\tconst { col, row } = activeSquare;\n\t\t\t\tswitch (key) {\n\t\t\t\t\tcase \"Backspace\":\n\t\t\t\t\tcase \"Delete\":\n\t\t\t\t\t\tactiveSquare.value = \"\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"ArrowUp\":\n\t\t\t\t\t\tsetActiveSquare(\n\t\t\t\t\t\t\tgrid.find(squareMatcher({ col: col - 1, row })) ||\n\t\t\t\t\t\t\t\tactiveSquare\n\t\t\t\t\t\t);\n\t\t\t\t\t\treturn;\n\t\t\t\t\tcase \"ArrowDown\":\n\t\t\t\t\t\tsetActiveSquare(\n\t\t\t\t\t\t\tgrid.find(squareMatcher({ col: col + 1, row })) ||\n\t\t\t\t\t\t\t\tactiveSquare\n\t\t\t\t\t\t);\n\t\t\t\t\t\treturn;\n\t\t\t\t\tcase \"ArrowLeft\":\n\t\t\t\t\t\tsetActiveSquare(\n\t\t\t\t\t\t\tgrid.find(squareMatcher({ col, row: row - 1 })) ||\n\t\t\t\t\t\t\t\tactiveSquare\n\t\t\t\t\t\t);\n\t\t\t\t\t\treturn;\n\t\t\t\t\tcase \"ArrowRight\":\n\t\t\t\t\t\tsetActiveSquare(\n\t\t\t\t\t\t\tgrid.find(squareMatcher({ col, row: row + 1 })) ||\n\t\t\t\t\t\t\t\tactiveSquare\n\t\t\t\t\t\t);\n\t\t\t\t\t\treturn;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsetGrid([...grid]);\n\t\t\tworkUpdater();\n\t\t} else if (\n\t\t\t[\"ArrowUp\", \"ArrowDown\", \"ArrowLeft\", \"ArrowRight\"].includes(key)\n\t\t) {\n\t\t\tsetActiveSquare(grid.find(squareMatcher({ col: 0, row: 0 })));\n\t\t}\n\t};\n\n\tconst renderSquare = (square) => {\n\t\tconst matchSquare = squareMatcher(square);\n\t\tconst cage =\n\t\t\tsquare.result && cages\n\t\t\t\t? cages.find((cage) => cage.squares.find(matchSquare))\n\t\t\t\t: null;\n\t\tconst classList =\n\t\t\t\"calcudoku-square \" +\n\t\t\tsquare.neighbors.join(\" \") +\n\t\t\t(square === activeSquare ? \" active\" : \"\") +\n\t\t\t(name.match(\"4x4beginner1\") && isDuplicate(grid, square)\n\t\t\t\t? \" duplicate\"\n\t\t\t\t: \"\") +\n\t\t\t((name.match(\"4x4beginner1\") || name.match(\"4x4beginner2\")) &&\n\t\t\tcage &&\n\t\t\thasError(grid, cage)\n\t\t\t\t? \" cageError\"\n\t\t\t\t: \"\");\n\t\treturn (\n\t\t\t<div className={classList} onClick={() => setActiveSquare(square)}>\n\t\t\t\t<div className=\"cage-indicator\">\n\t\t\t\t\t{square.result}\n\t\t\t\t\t{square.operation}\n\t\t\t\t</div>\n\t\t\t\t<input type=\"number\" value={square.value || \"\"} disabled />\n\t\t\t\t<div className=\"selector\"></div>\n\t\t\t</div>\n\t\t);\n\t};\n\n\tconst renderNumberSelect = (number) => {\n\t\treturn (\n\t\t\t<button\n\t\t\t\tclassName=\"number-select\"\n\t\t\t\tkey={`num${number}`}\n\t\t\t\tonClick={() => {\n\t\t\t\t\tactiveSquare.value = number;\n\t\t\t\t\tsetGrid([...grid]);\n\t\t\t\t\tworkUpdater();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{number}\n\t\t\t</button>\n\t\t);\n\t};\n\n\tuseUpdateActivePuzzle(\"calcudoku\", name);\n\tuseUpdateCompleted(\"calcudoku\", name, checkComplete);\n\tuseEffect(() => {\n\t\twindow.addEventListener(\"keydown\", downHandler);\n\t\treturn () => window.removeEventListener(\"keydown\", downHandler);\n\t});\n\n\treturn (\n\t\t<div>\n\t\t\t{grid ? (\n\t\t\t\t<div className=\"puzzle-container\" size={size}>\n\t\t\t\t\t<div className=\"saving-indicator\">\n\t\t\t\t\t\t{saveStatus === \"saving\"\n\t\t\t\t\t\t\t? \"Saving...\"\n\t\t\t\t\t\t\t: saveStatus === \"error\"\n\t\t\t\t\t\t\t? \"An error occurred while saving.\"\n\t\t\t\t\t\t\t: saveStatus === \"saved\"\n\t\t\t\t\t\t\t? \"Saved.\"\n\t\t\t\t\t\t\t: \" \"}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"grid-container\" size={size}>\n\t\t\t\t\t\t{grid.map(renderSquare)}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"number-select-container\">\n\t\t\t\t\t\t{new Array(size)\n\t\t\t\t\t\t\t.fill(null)\n\t\t\t\t\t\t\t.map((...[, number]) =>\n\t\t\t\t\t\t\t\trenderNumberSelect(number + 1)\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t) : (\n\t\t\t\t<h2 className=\"loading-indicator\">Loading...</h2>\n\t\t\t)}\n\t\t</div>\n\t);\n}\n\nfunction generateGrid(puzzleData) {\n\tconst { size, cages, work } = puzzleData;\n\tconst squares = Array(size ** 2).fill(null);\n\treturn squares.map((...[, index]) => {\n\t\tconst col = Math.floor(index / size);\n\t\tconst row = index % size;\n\t\tconst matchSquare = squareMatcher({ col, row });\n\t\tconst entry = work.find(matchSquare);\n\t\tconst cage = cages.find((cage) => cage.squares.find(matchSquare));\n\t\tconst neighbors = neighborList({ col, row }, cage);\n\t\tconst isTopLeft = cage.squares.every(\n\t\t\t(square) =>\n\t\t\t\tsquare.col >= col && (square.row >= row || square.col > col)\n\t\t);\n\t\tconst result = isTopLeft ? cage.result : null;\n\t\tconst operation = isTopLeft ? parsedOperations[cage.operation] : null;\n\t\tconst value = entry ? entry.value : null;\n\t\treturn { col, row, value, neighbors, result, operation };\n\t});\n}\n\nfunction neighborList(square, cage) {\n\tconst neighbors = [];\n\tconst directions = {\n\t\t\"n-up\": { col: square.col - 1, row: square.row },\n\t\t\"n-down\": { col: square.col + 1, row: square.row },\n\t\t\"n-left\": { col: square.col, row: square.row - 1 },\n\t\t\"n-right\": { col: square.col, row: square.row + 1 },\n\t};\n\n\tfor (let dir in directions) {\n\t\tconst matchSquare = squareMatcher(directions[dir]);\n\t\tif (cage.squares.find(matchSquare)) {\n\t\t\tneighbors.push(dir);\n\t\t}\n\t}\n\n\treturn neighbors;\n}\n\nfunction squareMatcher({ col, row }) {\n\treturn (square) => square.col === col && square.row === row;\n}\n\nfunction isDuplicate(grid, { col, row, value }) {\n\treturn grid.some(\n\t\t(square) =>\n\t\t\t(square.row === row || square.col === col) &&\n\t\t\t!(square.row === row && square.col === col) &&\n\t\t\tsquare.value === value\n\t);\n}\n\nfunction hasError(grid, { squares, operation, result }) {\n\tconst gridValues = squares.map(\n\t\t(square) => +grid.find(squareMatcher(square)).value\n\t);\n\tif (gridValues.some((val) => !val)) return false;\n\tlet reducer, startVal;\n\tswitch (operation) {\n\t\tcase \"+\":\n\t\t\tstartVal = 0;\n\t\t\treducer = (index) => (a, b) => a + b;\n\t\t\tbreak;\n\t\tcase \"-\":\n\t\t\tstartVal = 0;\n\t\t\treducer = (index) => (a, b, i) => (i === index ? a + b : a - b);\n\t\t\tbreak;\n\t\tcase \"*\":\n\t\t\tstartVal = 1;\n\t\t\treducer = (index) => (a, b) => a * b;\n\t\t\tbreak;\n\t\tcase \"/\":\n\t\t\tstartVal = 1;\n\t\t\treducer = (index) => (a, b, i) => (i === index ? a * b : a / b);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tstartVal = 0;\n\t\t\treducer = (index) => (a, b) => b;\n\t}\n\tconst results = gridValues.map((val, index, gridvals) =>\n\t\tgridvals.reduce(reducer(index), startVal)\n\t);\n\n\treturn !results.includes(+result);\n}\n","import React from \"react\";\nimport Instructions from \"./instructions\";\nimport Instance from \"./instance\";\nimport { fetchUserData } from \"../../api-utils\";\n\nconst name = \"Calcudokus\";\nconst id = \"calcudoku\";\n\nfunction ListPreview() {\n\treturn <div className=\"list-preview\">Find all calcudokus here</div>;\n}\n\nconst instanceList = [\n\t{ instance: \"instructions\", title: \"Instructions\" },\n\t{ instance: \"4x4beginner1\", title: \"4x4 Beginner 1\" },\n\t{ instance: \"4x4beginner2\", title: \"4x4 Beginner 2\" },\n\t{ instance: \"4x4beginner3\", title: \"4x4 Beginner 3\" },\n\t{ instance: \"4x4beginner4\", title: \"4x4 Beginner 4\" },\n\t{ instance: \"4x4beginner5\", title: \"4x4 Beginner 5\" },\n\t{ instance: \"4x4intermediate1\", title: \"4x4 Intermediate 1\" },\n\t{ instance: \"4x4intermediate2\", title: \"4x4 Intermediate 2\" },\n\t{ instance: \"4x4intermediate3\", title: \"4x4 Intermediate 3\" },\n\t{ instance: \"4x4intermediate4\", title: \"4x4 Intermediate 4\" },\n\t{ instance: \"4x4expert1\", title: \"4x4 Expert 1\" },\n\t{ instance: \"4x4expert2\", title: \"4x4 Expert 2\" },\n\t{ instance: \"4x4expert3\", title: \"4x4 Expert 3\" },\n\t{ instance: \"5x5beginner1\", title: \"5x5 Beginner 1\" },\n\t{ instance: \"5x5beginner2\", title: \"5x5 Beginner 2\" },\n\t{ instance: \"5x5intermediate1\", title: \"5x5 Intermediate 1\" },\n];\n\ninstanceList.fetchCompletionStatus = fetchUserData;\n\nexport { name, id, ListPreview, Instructions, Instance, instanceList };\n","import React, { useState, useEffect, useCallback, useRef } from \"react\";\nimport { useUpdateActivePuzzle, useUpdateWork } from \"../../api-utils.js\";\n\nexport default function Instance(props) {\n\tconst { name } = props;\n\tconst sessionDataKey = `logic-instance-data-${name}`;\n\tconst sessionData = JSON.parse(sessionStorage.getItem(sessionDataKey));\n\tconst { description } = sessionData;\n\tconst [work, setWork] = useState(sessionData.work);\n\tconst [saveStatus, setSaveStatus] = useState(\"saved\");\n\tconst [updateTimer, setUpdateTimer] = useState(30);\n\tconst initializing = useRef(true);\n\tconst updateWork = useUpdateWork(\"logic\", name, setSaveStatus);\n\tconst workUpdater = useCallback(() => updateWork(work), [work]);\n\n\tuseUpdateActivePuzzle(\"logic\", name);\n\n\tuseEffect(() => {\n\t\tif (initializing.current) return (initializing.current = false);\n\t\tsetSaveStatus(null);\n\t\tconst clearHistoryListener = props.history.listen(workUpdater);\n\t\tconst updateTimer = setTimeout(workUpdater, 3000);\n\t\treturn () => {\n\t\t\tclearTimeout(updateTimer);\n\t\t\tclearHistoryListener();\n\t\t};\n\t}, [workUpdater, props.history, setSaveStatus, initializing]);\n\n\tuseEffect(() => {\n\t\tconst conditionalUpdater = () => {\n\t\t\tif (saveStatus !== \"saved\") workUpdater();\n\t\t};\n\t\twindow.addEventListener(\"beforeunload\", conditionalUpdater);\n\t\treturn () => {\n\t\t\twindow.removeEventListener(\"beforeunload\", conditionalUpdater);\n\t\t};\n\t}, [workUpdater, saveStatus]);\n\n\tuseEffect(() => {\n\t\tif (updateTimer === 0) {\n\t\t\tsetUpdateTimer(30);\n\t\t\tif (!saveStatus) workUpdater();\n\t\t}\n\t}, [updateTimer, workUpdater, saveStatus]);\n\n\tuseEffect(() => {\n\t\tconst timeInterval = setInterval(\n\t\t\t() => setUpdateTimer((timer) => timer - 1),\n\t\t\t1000\n\t\t);\n\t\treturn () => clearInterval(timeInterval);\n\t}, [setUpdateTimer]);\n\n\treturn description ? (\n\t\t<div className=\"logic instance\">\n\t\t\t<p className=\"puzzle-description\">{description}</p>\n\t\t\t<textarea\n\t\t\t\tclassName=\"work\"\n\t\t\t\tonChange={(e) => {\n\t\t\t\t\tsetWork(e.target.value);\n\t\t\t\t\t//workUpdater();\n\t\t\t\t}}\n\t\t\t\tvalue={work}\n\t\t\t\tplaceholder=\"Enter your solution or any notes here!\"\n\t\t\t/>\n\t\t\t<div className=\"saving-indicator\">\n\t\t\t\t{saveStatus === \"saving\"\n\t\t\t\t\t? \"Saving...\"\n\t\t\t\t\t: saveStatus === \"error\"\n\t\t\t\t\t? \"An error occurred while saving.\"\n\t\t\t\t\t: saveStatus === \"saved\"\n\t\t\t\t\t? \"Saved.\"\n\t\t\t\t\t: \" \"}\n\t\t\t</div>\n\t\t</div>\n\t) : (\n\t\t<h2 className=\"loading-indicator\">Loading...</h2>\n\t);\n}\n","import React from \"react\";\nimport Instance from \"./instance\";\nimport { fetchUserData } from \"../../api-utils\";\n\nconst name = \"Logic Puzzles\";\nconst id = \"logic\";\n\nfunction ListPreview() {\n\treturn <div className=\"list-preview\">Find all logic puzzles here</div>;\n}\n\nconst instanceList = [\n\t{ instance: \"wolfgoatcabbage\", title: \"Wolf, Goat, Cabbage\" },\n\t{ instance: \"torch\", title: \"Bridge & Torch\" },\n\t{ instance: \"goldboxes\", title: \"Find the Gold\" },\n\t{ instance: \"10coins\", title: \"10 Coins\" },\n\t{ instance: \"socks\", title: \"Cathy's Socks\" },\n\t{\n\t\tinstance: \"childrenboat\",\n\t\ttitle: \"2 Adults, 2 Children, a Boat, and a River\",\n\t},\n\t{ instance: \"applesandoranges\", title: \"Apples & Oranges\" },\n\t{ instance: \"averybobbycam\", title: \"Avery, Bobby, & Cam\" },\n\t{ instance: \"bear\", title: \"Bear\" },\n\t{ instance: \"hats\", title: \"Hats\" },\n];\n\ninstanceList.fetchCompletionStatus = fetchUserData;\n\nexport { name, id, ListPreview, Instance, instanceList };\n","import React, { useState, useCallback } from \"react\";\nimport {\n\tuseUpdateActivePuzzle,\n\tuseUpdateCompleted,\n\tuseUpdateWork,\n} from \"../../api-utils.js\";\n\nexport default function Instance({ name }) {\n\tconst sessionDataKey = `light-instance-data-${name}`;\n\tconst data = JSON.parse(sessionStorage.getItem(sessionDataKey));\n\tconst [work, setWork] = useState(data.work);\n\tconst [workPosition, setWorkPosition] = useState(\n\t\tdata.workPosition || work.length\n\t);\n\tconst {\n\t\tsize: { cols, rows },\n\t\tbeginstate,\n\t\tneighborType,\n\t} = data;\n\tconst [saveStatus, setSaveStatus] = useState(\"saved\");\n\tconst updateWork = useUpdateWork(\"light\", name, setSaveStatus);\n\n\tconst neighborList = ({ row, col }) => {\n\t\tswitch (neighborType) {\n\t\t\tcase \"x\":\n\t\t\t\treturn [\n\t\t\t\t\t{ row: row - 1, col: col - 1 },\n\t\t\t\t\t{ row: row + 1, col: col + 1 },\n\t\t\t\t\t{ row: row + 1, col: col - 1 },\n\t\t\t\t\t{ row: row - 1, col: col + 1 },\n\t\t\t\t\t{ row, col },\n\t\t\t\t];\n\t\t\tdefault:\n\t\t\t\treturn [\n\t\t\t\t\t{ row: row - 1, col },\n\t\t\t\t\t{ row: row + 1, col },\n\t\t\t\t\t{ row, col: col - 1 },\n\t\t\t\t\t{ row, col: col + 1 },\n\t\t\t\t\t{ row, col },\n\t\t\t\t];\n\t\t}\n\t};\n\n\tconst isActive = useCallback(\n\t\t(square) => {\n\t\t\tconst neighbors = neighborList(square);\n\t\t\tconst activatedNeighbors = work\n\t\t\t\t.slice(0, workPosition)\n\t\t\t\t.filter((sq) => neighbors.some(squareMatcher(sq)));\n\t\t\treturn (\n\t\t\t\t(activatedNeighbors.length +\n\t\t\t\t\t(beginstate.some(squareMatcher(square)) ? 1 : 0)) %\n\t\t\t\t\t2 >\n\t\t\t\t0\n\t\t\t);\n\t\t},\n\t\t[work, workPosition, beginstate]\n\t);\n\n\tconst checkComplete = useCallback(() => {\n\t\tfor (let row = 0; row < rows; row++) {\n\t\t\tfor (let col = 0; col < cols; col++) {\n\t\t\t\tif (!isActive({ row, col })) return false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}, [cols, rows, isActive]);\n\n\tconst triggerSquare = (square) => {\n\t\tconst updatedWork = [...work.slice(0, workPosition), square];\n\t\tsetWorkPosition(workPosition + 1);\n\t\tsetWork(updatedWork);\n\t\tupdateWork(updatedWork);\n\t};\n\n\tconst renderSquare = (row, ...[, col]) => {\n\t\tconst classList = `light-square ${\n\t\t\tisActive({ row, col }) ? \"active\" : \"inactive\"\n\t\t}`;\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName={classList}\n\t\t\t\tonClick={() => triggerSquare({ row, col })}\n\t\t\t/>\n\t\t);\n\t};\n\n\tconst renderRow = (...[, index]) => {\n\t\treturn (\n\t\t\t<div className=\"grid-row\">\n\t\t\t\t{Array(cols).fill(null).map(renderSquare.bind(null, index))}\n\t\t\t</div>\n\t\t);\n\t};\n\n\tconst jumpTo = (position) => {\n\t\tsetWorkPosition(position);\n\t\tconst newSessionData = JSON.parse(\n\t\t\tsessionStorage.getItem(sessionDataKey)\n\t\t);\n\t\tnewSessionData.workPosition = position;\n\t\tsessionStorage.setItem(sessionDataKey, JSON.stringify(newSessionData));\n\t};\n\n\tuseUpdateCompleted(\"light\", name, checkComplete);\n\tuseUpdateActivePuzzle(\"light\", name);\n\n\treturn (\n\t\t<div className=\"light-puzzle-container\">\n\t\t\t<div className=\"moves-indicator\">\n\t\t\t\tMoves: <span className=\"moves\">{workPosition}</span>\n\t\t\t</div>\n\t\t\t<div className=\"light-grid\" cols={cols} rows={rows}>\n\t\t\t\t{new Array(rows).fill(null).map(renderRow)}\n\t\t\t</div>\n\t\t\t<div className=\"controller\">\n\t\t\t\t<JumpBack jump={() => jumpTo(0)} isactive={workPosition > 0} />\n\t\t\t\t<StepBack\n\t\t\t\t\tstep={() => jumpTo(Math.max(workPosition - 1, 0))}\n\t\t\t\t\tisactive={workPosition > 0}\n\t\t\t\t/>\n\t\t\t\t<StepForward\n\t\t\t\t\tstep={() => jumpTo(Math.min(workPosition + 1, work.length))}\n\t\t\t\t\tisactive={workPosition < work.length}\n\t\t\t\t/>\n\t\t\t\t<JumpForward\n\t\t\t\t\tjump={() => jumpTo(work.length)}\n\t\t\t\t\tisactive={workPosition < work.length}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div className=\"saving-indicator\">\n\t\t\t\t{saveStatus === \"saving\"\n\t\t\t\t\t? \"Saving...\"\n\t\t\t\t\t: saveStatus === \"error\"\n\t\t\t\t\t? \"An error occurred while saving.\"\n\t\t\t\t\t: saveStatus === \"saved\"\n\t\t\t\t\t? \"Saved.\"\n\t\t\t\t\t: \" \"}\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nfunction squareMatcher({ row, col }) {\n\treturn (square) => square.col === col && square.row === row;\n}\n\nexport function StepBack({ step, isactive }) {\n\treturn (\n\t\t<svg\n\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\twidth=\"2048\"\n\t\t\theight=\"2048\"\n\t\t\tviewBox=\"0 0 2048 2048\"\n\t\t\tonClick={step}\n\t\t\tclassName=\"step back nav-button\"\n\t\t\tisactive={isactive.toString()}\n\t\t>\n\t\t\t<path\n\t\t\t\td=\"M1344 576v896q0 26-19 45t-45\n\t\t\t\t19-45-19l-448-448q-19-19-19-45t19-45l448-448q19-19 45-19t45 19\n\t\t\t\t19 45z\"\n\t\t\t/>\n\t\t</svg>\n\t);\n}\n\nexport function JumpBack({ jump, isactive }) {\n\treturn (\n\t\t<svg\n\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\twidth=\"2048\"\n\t\t\theight=\"2048\"\n\t\t\tviewBox=\"0 0 2048 2048\"\n\t\t\tonClick={jump}\n\t\t\tclassName=\"jump back nav-button\"\n\t\t\tisactive={isactive.toString()}\n\t\t>\n\t\t\t<path\n\t\t\t\td=\"M1811 269q19-19 32-13t13 32v1472q0 \n\t\t\t26-13 32t-32-13l-710-710q-8-9-13-19v710q0 \n\t\t\t26-13 32t-32-13l-710-710q-19-19-19-45t19-45l710-710q19-19 \n\t\t\t32-13t13 32v710q5-11 13-19z\"\n\t\t\t/>\n\t\t</svg>\n\t);\n}\n\nexport function StepForward({ step, isactive }) {\n\treturn (\n\t\t<svg\n\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\twidth=\"2048\"\n\t\t\theight=\"2048\"\n\t\t\tviewBox=\"0 0 2048 2048\"\n\t\t\tonClick={step}\n\t\t\tclassName=\"step forward nav-button\"\n\t\t\tisactive={isactive.toString()}\n\t\t>\n\t\t\t<path\n\t\t\t\td=\"M1280 1024q0 26-19 45l-448 448q-19 19-45 \n\t\t\t\t19t-45-19-19-45v-896q0-26 19-45t45-19 45 \n\t\t\t\t19l448 448q19 19 19 45z\"\n\t\t\t/>\n\t\t</svg>\n\t);\n}\n\nexport function JumpForward({ jump, isactive }) {\n\treturn (\n\t\t<svg\n\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\twidth=\"2048\"\n\t\t\theight=\"2048\"\n\t\t\tviewBox=\"0 0 2048 2048\"\n\t\t\tonClick={jump}\n\t\t\tclassName=\"jump forward nav-button\"\n\t\t\tisactive={isactive.toString()}\n\t\t>\n\t\t\t<path\n\t\t\t\td=\"M237 1779q-19 19-32 13t-13-32v-1472q0-26 13-32t32 13l710 \n\t\t\t\t710q8 8 13 19v-710q0-26 13-32t32 13l710 710q19 19 19 45t-19 \n\t\t\t\t45l-710 710q-19 19-32 13t-13-32v-710q-5 10-13 19z\"\n\t\t\t/>\n\t\t</svg>\n\t);\n}\n","import React, { useState } from \"react\";\nimport { JumpBack, JumpForward, StepBack, StepForward } from \"./instance\";\n\nconst example1 = { size: { cols: 1, rows: 1 }, beginstate: [], work: [] };\nconst example2 = { size: { cols: 3, rows: 1 }, beginstate: [], work: [] };\nconst example3 = { size: { cols: 3, rows: 3 }, beginstate: [], work: [] };\nconst example4 = {\n\tsize: { cols: 3, rows: 3 },\n\tbeginstate: [],\n\twork: [],\n\tneighborType: \"x\",\n};\n\nexport default function Instructions({ history }) {\n\treturn (\n\t\t<div className=\"light-instructions\">\n\t\t\t<h2>\n\t\t\t\tLight Puzzle Instructions\n\t\t\t\t<hr />\n\t\t\t</h2>\n\t\t\t<div className=\"steps\">\n\t\t\t\t<div className=\"step\">\n\t\t\t\t\t<p>\n\t\t\t\t\t\tHere, the goal is to light up all the squares. Clicking\n\t\t\t\t\t\ta square toggles it on and off (clicking a dark square\n\t\t\t\t\t\twill light it up and clicking a lit square will make it\n\t\t\t\t\t\tdark again).\n\t\t\t\t\t</p>\n\t\t\t\t\t<Instance data={example1} />\n\t\t\t\t</div>\n\t\t\t\t<div className=\"step\">\n\t\t\t\t\t<p>\n\t\t\t\t\t\tHowever, when you click on a square the same thing will\n\t\t\t\t\t\thappen to squares that are next to it.\n\t\t\t\t\t</p>\n\t\t\t\t\t<Instance data={example2} />\n\t\t\t\t</div>\n\t\t\t\t<div className=\"step\">\n\t\t\t\t\t<p>\n\t\t\t\t\t\tYou can use the navigation buttons at the bottom of the\n\t\t\t\t\t\tpuzzle to go back and forward through the moves you've\n\t\t\t\t\t\tmade.\n\t\t\t\t\t</p>\n\t\t\t\t\t<Instance data={example2} showNav={true} />\n\t\t\t\t</div>\n\t\t\t\t<div className=\"step\">\n\t\t\t\t\t<p className=\"emphasized\">\n\t\t\t\t\t\tIt can be tempting to click randomly, but take it slow!\n\t\t\t\t\t\tTry to light up all the squares using as few moves as\n\t\t\t\t\t\tyou can!\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<button\n\t\t\t\tclassName=\"try-it\"\n\t\t\t\tonClick={() => history.push(\"/light\")}\n\t\t\t>\n\t\t\t\tTry It!\n\t\t\t</button>\n\t\t</div>\n\t);\n}\n\nexport function InstructionsX({ history }) {\n\treturn (\n\t\t<div className=\"light-instructions\">\n\t\t\t<h2>\n\t\t\t\tLight Puzzle-X Instructions\n\t\t\t\t<hr />\n\t\t\t</h2>\n\t\t\t<div className=\"steps\">\n\t\t\t\t<div className=\"step\">\n\t\t\t\t\t<p>\n\t\t\t\t\t\tPuzzles marked with an \"X\" work a little differently.\n\t\t\t\t\t\tClicking a square will light up squares the diagonal to\n\t\t\t\t\t\tit instead of ones directly next to it.\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"examples\">\n\t\t\t\t\t<div className=\"example\">\n\t\t\t\t\t\tNormal Puzzle\n\t\t\t\t\t\t<Instance data={example3} />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"example\">\n\t\t\t\t\t\tPuzzle-X\n\t\t\t\t\t\t<Instance data={example4} />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<button\n\t\t\t\tclassName=\"try-it\"\n\t\t\t\tonClick={() => history.push(\"/light/smallx\")}\n\t\t\t>\n\t\t\t\tTry It!\n\t\t\t</button>\n\t\t</div>\n\t);\n}\n\nfunction Instance({ data, showNav }) {\n\tconst [work, setWork] = useState(data.work);\n\tconst [workPosition, setWorkPosition] = useState(0);\n\tconst {\n\t\tsize: { cols, rows },\n\t\tbeginstate,\n\t\tneighborType,\n\t} = data;\n\n\tconst neighborList = ({ row, col }) => {\n\t\tswitch (neighborType) {\n\t\t\tcase \"x\":\n\t\t\t\treturn [\n\t\t\t\t\t{ row: row - 1, col: col - 1 },\n\t\t\t\t\t{ row: row + 1, col: col + 1 },\n\t\t\t\t\t{ row: row + 1, col: col - 1 },\n\t\t\t\t\t{ row: row - 1, col: col + 1 },\n\t\t\t\t\t{ row, col },\n\t\t\t\t];\n\t\t\tdefault:\n\t\t\t\treturn [\n\t\t\t\t\t{ row: row - 1, col },\n\t\t\t\t\t{ row: row + 1, col },\n\t\t\t\t\t{ row, col: col - 1 },\n\t\t\t\t\t{ row, col: col + 1 },\n\t\t\t\t\t{ row, col },\n\t\t\t\t];\n\t\t}\n\t};\n\n\tconst jumpTo = (position) => {\n\t\tsetWorkPosition(position);\n\t};\n\n\tconst triggerSquare = (square) => {\n\t\tsetWork([...work.slice(0, workPosition), square]);\n\t\tsetWorkPosition(workPosition + 1);\n\t};\n\n\tconst renderSquare = (row, ...[, col]) => {\n\t\tconst neighbors = neighborList({ row, col });\n\t\tconst activatedNeighbors = work\n\t\t\t.slice(0, workPosition)\n\t\t\t.filter((square) => neighbors.some(squareMatcher(square)));\n\t\tconst isactive =\n\t\t\t(activatedNeighbors.length +\n\t\t\t\t(beginstate.some(squareMatcher({ row, col })) ? 1 : 0)) %\n\t\t\t\t2 >\n\t\t\t0;\n\t\tconst classList = `light-square ${isactive ? \"active\" : \"inactive\"}`;\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName={classList}\n\t\t\t\tonClick={() => triggerSquare({ row, col })}\n\t\t\t/>\n\t\t);\n\t};\n\n\tconst renderRow = (...[, index]) => {\n\t\treturn (\n\t\t\t<div className=\"grid-row\">\n\t\t\t\t{Array(cols).fill(null).map(renderSquare.bind(null, index))}\n\t\t\t</div>\n\t\t);\n\t};\n\n\treturn (\n\t\t<div className=\"light-puzzle-container\">\n\t\t\t<div className=\"light-grid\" cols={cols} rows={rows}>\n\t\t\t\t{new Array(rows).fill(null).map(renderRow)}\n\t\t\t</div>\n\t\t\t{showNav ? (\n\t\t\t\t<div className=\"controller\">\n\t\t\t\t\t<JumpBack\n\t\t\t\t\t\tjump={() => jumpTo(0)}\n\t\t\t\t\t\tisactive={workPosition > 0}\n\t\t\t\t\t/>\n\t\t\t\t\t<StepBack\n\t\t\t\t\t\tstep={() => jumpTo(Math.max(workPosition - 1, 0))}\n\t\t\t\t\t\tisactive={workPosition > 0}\n\t\t\t\t\t/>\n\t\t\t\t\t<StepForward\n\t\t\t\t\t\tstep={() =>\n\t\t\t\t\t\t\tjumpTo(Math.min(workPosition + 1, work.length))\n\t\t\t\t\t\t}\n\t\t\t\t\t\tisactive={workPosition < work.length}\n\t\t\t\t\t/>\n\t\t\t\t\t<JumpForward\n\t\t\t\t\t\tjump={() => jumpTo(work.length)}\n\t\t\t\t\t\tisactive={workPosition < work.length}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t) : null}\n\t\t</div>\n\t);\n}\n\nfunction squareMatcher({ row, col }) {\n\treturn (square) => square.col === col && square.row === row;\n}\n","import React, { useState, useEffect } from \"react\";\nimport { Route, Switch } from \"react-router-dom\";\nimport Instance from \"./instance\";\nimport { InstructionsX } from \"./instructions\";\n\nconst instanceList = Array.from({ length: 5 }, (...[, i]) => i + 1);\n\nexport default function List({ history, name, match }) {\n\tconst [current, setCurrent] = useState(1);\n\n\tuseEffect(() => {\n\t\tif (!name.match(\"instructions\")) {\n\t\t\thistory.push(`/light/${name}/${current}`);\n\t\t}\n\t}, [current, name, history]);\n\n\tconst renderInstanceRoute = (match, instance) => {\n\t\treturn (\n\t\t\t<Route\n\t\t\t\tkey={instance}\n\t\t\t\tpath={`${match.url}/${instance}`}\n\t\t\t\trender={(props) => (\n\t\t\t\t\t<Instance {...props} name={`${name}${instance}`} />\n\t\t\t\t)}\n\t\t\t/>\n\t\t);\n\t};\n\n\tconst renderInstanceSelector = (instance) => (\n\t\t<button\n\t\t\tkey={`selector-${instance}`}\n\t\t\tonClick={() => setCurrent(instance)}\n\t\t\tclassName={`instance selector ${\n\t\t\t\tinstance === current ? \"selected\" : \"\"\n\t\t\t}`}\n\t\t></button>\n\t);\n\n\tconst next = () => setCurrent(Math.min(current + 1, 5));\n\n\tconst previous = () => setCurrent(Math.max(current - 1, 1));\n\n\treturn name === \"instructionsx\" ? (\n\t\t<InstructionsX history={history} />\n\t) : (\n\t\t<div className={`light category-container ${name}`}>\n\t\t\t{/*<h2>{`Light Puzzles - ${capitalize(name)} `}</h2>;*/}\n\t\t\t<Switch>\n\t\t\t\t{instanceList.map(renderInstanceRoute.bind(null, match))}\n\t\t\t\t<Route render={() => history.push(\"/light\")} />\n\t\t\t</Switch>\n\t\t\t<div className=\"selector-container\">\n\t\t\t\t<button\n\t\t\t\t\tclassName={`previous selector  ${\n\t\t\t\t\t\tcurrent === 1 ? \"inactive\" : \"active\"\n\t\t\t\t\t}`}\n\t\t\t\t\tonClick={previous}\n\t\t\t\t>\n\t\t\t\t\tPrev\n\t\t\t\t</button>\n\t\t\t\t{instanceList.map(renderInstanceSelector)}\n\t\t\t\t<button\n\t\t\t\t\tclassName={`next selector  ${\n\t\t\t\t\t\tcurrent === instanceList.length ? \"inactive\" : \"active\"\n\t\t\t\t\t}`}\n\t\t\t\t\tonClick={next}\n\t\t\t\t>\n\t\t\t\t\tNext\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nfunction capitalize(string) {\n\treturn string.replace(/^./, (char) => char.toUpperCase());\n}\n","import React from \"react\";\nimport List from \"./instance-list\";\nimport Instructions from \"./instructions\";\nimport { fetchUserData } from \"../../api-utils\";\n\nconst name = \"Light Puzzles\";\nconst id = \"light\";\n\nfunction ListPreview() {\n\treturn <div className=\"list-preview\">Find all light puzzles here</div>;\n}\n\nconst instanceList = [\n\t{ instance: \"instructions\", title: \"Instructions\" },\n\t{ instance: \"small\", title: \"Small\" },\n\t{ instance: \"medium\", title: \"Medium\" },\n\t{ instance: \"large\", title: \"Large\" },\n\t{ instance: \"instructionsx\", title: \"Instructions-X\" },\n\t{ instance: \"smallx\", title: \"Small-X\" },\n\t{ instance: \"mediumx\", title: \"Medium-X\" },\n\t{ instance: \"largex\", title: \"Large-X\" },\n];\n\ninstanceList.fetchCompletionStatus = async function (user) {\n\tfetchUserData(user);\n\tinstanceList.forEach(({ instance }) => {\n\t\tif (instance.match(\"instructions\")) return;\n\t\tlet completed = true;\n\t\tfor (let i = 1; i <= 5; i++) {\n\t\t\tconst sessionDataKey = `light-instance-data-${instance}${i}`;\n\t\t\tconst sessionData = JSON.parse(\n\t\t\t\tsessionStorage.getItem(sessionDataKey)\n\t\t\t);\n\t\t\tif (!sessionData || !sessionData.completed) completed = false;\n\t\t}\n\t\tsessionStorage.setItem(\n\t\t\t`light-instance-data-${instance}`,\n\t\t\tJSON.stringify({ completed })\n\t\t);\n\t});\n};\n\nconst Instance = List;\n\nexport { name, id, ListPreview, instanceList, Instance, Instructions };\n","function orthogonalVector(vector) {\n  return { x: vector.y, y: -vector.x };\n}\n\nexport function distanceFromSegment(point, [initial, terminal]) {\n  const orthogonal = orthogonalVector({\n    x: terminal.x - initial.x,\n    y: terminal.y - initial.y,\n  });\n  const initialLine = [initial, sum(initial, orthogonal)];\n  const terminalLine = [terminal, sum(terminal, orthogonal)];\n  const isBetweenEndpoints =\n    distanceFromLine(point, initialLine) +\n      distanceFromLine(point, terminalLine) <=\n    distanceFromPoint(initial, terminal) + 1;\n\n  const distance = isBetweenEndpoints\n    ? distanceFromLine(point, [initial, terminal])\n    : Math.min(\n        distanceFromPoint(point, initial),\n        distanceFromPoint(point, terminal)\n      );\n  return distance;\n}\n\nexport function distanceFromPoint(pointA, pointB) {\n  return magnitude(difference(pointA, pointB));\n}\n\nfunction distanceFromLine(point, [initial, terminal]) {\n  const lineVector = difference(initial, terminal);\n  const pointVector = difference(point, initial);\n  return (\n    Math.abs(lineVector.x * pointVector.y - lineVector.y * pointVector.x) /\n    magnitude(lineVector)\n  );\n}\n\nexport function difference(vectorA, vectorB) {\n  return { x: vectorA.x - vectorB.x, y: vectorA.y - vectorB.y };\n}\n\nexport function sum(vectorA, vectorB) {\n  return { x: vectorA.x + vectorB.x, y: vectorA.y + vectorB.y };\n}\n\nexport function scalarProduct(vector, scalar) {\n  return { x: vector.x * scalar, y: vector.y * scalar };\n}\n\nexport function magnitude(vector) {\n  return Math.sqrt(vector.x ** 2 + vector.y ** 2);\n}\n\nfunction dotProduct(vector1, vector2) {\n  return vector1.x * vector2.x + vector1.y * vector2.y;\n}\n\nexport function onSameSide(point1, point2, [initial, terminal]) {\n  const vector1 = difference(point1, initial);\n  const vector2 = difference(point2, initial);\n  const orthogonal = orthogonalVector(difference(terminal, initial));\n  return dotProduct(vector1, orthogonal) * dotProduct(vector2, orthogonal) >= 0;\n}\n","import React, { useRef, useState, useEffect, useCallback } from \"react\";\nimport {\n\tdistanceFromSegment,\n\tdistanceFromPoint,\n\tsum,\n\tscalarProduct,\n\tmagnitude,\n\tdifference,\n} from \"../vector-logic\";\n\nexport default function Canvas(props) {\n\tconst canvasRef = useRef(null);\n\tconst { puzzleData, sticks, setSticks, updateWork } = props;\n\tconst {\n\t\theight,\n\t\twidth,\n\t\tselectionProximity,\n\t\tstartingConfiguration,\n\t\tstickLength,\n\t\tstickWidth,\n\t} = puzzleData;\n\tconst [activePoint, setActivePoint] = useState(null);\n\tconst [activeStick, setActiveStick] = useState(null);\n\tconst [mouseLoc, setMouseLoc] = useState({ x: 0, y: 0 });\n\n\tconst getMouseLoc = (e, locationObject = e) => {\n\t\tconst rect = e.target.getBoundingClientRect();\n\t\tconst mouseLocation = {\n\t\t\tx: ((locationObject.clientX - rect.left) / rect.width) * width,\n\t\t\ty: ((locationObject.clientY - rect.top) / rect.height) * height,\n\t\t};\n\t\tsetMouseLoc(mouseLocation);\n\t\treturn mouseLocation;\n\t};\n\n\tconst getPointSelection = useCallback(\n\t\t(mouseLocation) => {\n\t\t\tif (activeStick) return;\n\t\t\tconst points = sticks.flatMap((stick) => stick);\n\t\t\treturn points.reduce(\n\t\t\t\t(acc, point) => {\n\t\t\t\t\tconst distance = distanceFromPoint(point, mouseLocation);\n\t\t\t\t\tconst accDistance = acc\n\t\t\t\t\t\t? distanceFromPoint(mouseLocation, acc)\n\t\t\t\t\t\t: Infinity;\n\t\t\t\t\treturn distance < Math.min(accDistance, selectionProximity)\n\t\t\t\t\t\t? point\n\t\t\t\t\t\t: acc;\n\t\t\t\t},\n\n\t\t\t\tnull\n\t\t\t);\n\t\t},\n\t\t[sticks, selectionProximity, activeStick]\n\t);\n\n\tconst getStickSelection = useCallback(\n\t\t(mouseLocation) =>\n\t\t\tactiveStick ||\n\t\t\tsticks.reduce(\n\t\t\t\t(acc, stick) =>\n\t\t\t\t\tdistanceFromSegment(mouseLocation, stick) <\n\t\t\t\t\tMath.min(\n\t\t\t\t\t\tacc\n\t\t\t\t\t\t\t? distanceFromSegment(mouseLocation, acc)\n\t\t\t\t\t\t\t: Infinity,\n\t\t\t\t\t\tselectionProximity\n\t\t\t\t\t)\n\t\t\t\t\t\t? stick\n\t\t\t\t\t\t: acc,\n\t\t\t\tnull\n\t\t\t),\n\t\t[sticks, selectionProximity, activeStick]\n\t);\n\n\tconst selectPoint = (mouseLocation) => {\n\t\tconst selectedPoint = getPointSelection(mouseLocation);\n\t\tif (selectedPoint) {\n\t\t\tconst selectedStick = sticks.find((stick) =>\n\t\t\t\tstick.includes(selectedPoint)\n\t\t\t);\n\t\t\tsetActivePoint(selectedPoint);\n\t\t\tsetActiveStick(selectedStick);\n\t\t\treturn selectedPoint;\n\t\t}\n\t};\n\n\tconst selectStick = (mouseLocation) => {\n\t\tconst selectedStick = getStickSelection(mouseLocation);\n\t\tsetActiveStick(selectedStick);\n\t\treturn selectedStick;\n\t};\n\n\tconst select = (mouseLocation) => {\n\t\tconst selectedPoint = selectPoint(mouseLocation);\n\t\tif (!selectedPoint) {\n\t\t\tselectStick(mouseLocation);\n\t\t}\n\t};\n\n\tconst pointDrag = (mouseLocation) => {\n\t\tif (activePoint) {\n\t\t\tconst initial = activeStick.find((point) => point !== activePoint);\n\t\t\tconst vector = difference(mouseLocation, initial);\n\t\t\tconst adjustedVector = scalarProduct(\n\t\t\t\tvector,\n\t\t\t\tstickLength / magnitude(vector)\n\t\t\t);\n\t\t\tactivePoint.x = initial.x + adjustedVector.x;\n\t\t\tactivePoint.y = initial.y + adjustedVector.y;\n\t\t\tsetSticks([...sticks]);\n\t\t}\n\t};\n\n\tconst mouseStickDrag = (e) => {\n\t\tif (!activePoint && activeStick) {\n\t\t\tconst rect = e.target.getBoundingClientRect();\n\t\t\tfor (let i in activeStick) {\n\t\t\t\tconst point = activeStick[i];\n\t\t\t\tactiveStick[i] = {\n\t\t\t\t\tx: point.x + (e.movementX * width) / rect.width,\n\t\t\t\t\ty: point.y + (e.movementY * height) / rect.height,\n\t\t\t\t};\n\t\t\t}\n\t\t\tsetSticks([...sticks]);\n\t\t}\n\t};\n\n\tconst touchStickDrag = (touchLocation) => {\n\t\tif (!activePoint && activeStick) {\n\t\t\tconst stickReference = scalarProduct(sum(...activeStick), 1 / 2);\n\t\t\tconst adjustment = {\n\t\t\t\tx: touchLocation.x - stickReference.x,\n\t\t\t\ty: touchLocation.y - stickReference.y,\n\t\t\t};\n\t\t\tfor (let i in activeStick) {\n\t\t\t\tconst point = activeStick[i];\n\t\t\t\tactiveStick[i] = sum(point, adjustment);\n\t\t\t}\n\t\t\tsetSticks([...sticks]);\n\t\t}\n\t};\n\n\tconst touchHandler = (e) => {\n\t\tconst touch = e.touches[0];\n\t\tconst touchLocation = getMouseLoc(e, touch);\n\t\tconst selectedPoint = selectPoint(touchLocation);\n\t\tif (!selectedPoint) {\n\t\t\tselectStick(touchLocation);\n\t\t}\n\t};\n\n\tconst touchDragHandler = (e) => {\n\t\tconst touch = e.touches[0];\n\t\tconst touchLocation = getMouseLoc(e, touch);\n\t\tpointDrag(touchLocation);\n\t\ttouchStickDrag(touchLocation);\n\t};\n\n\tconst mouseMoveHandler = (e) => {\n\t\tconst mouseLocation = getMouseLoc(e);\n\t\tpointDrag(mouseLocation);\n\t\tmouseStickDrag(e);\n\t};\n\n\tconst mouseDownHandler = (e) => {\n\t\tselect(getMouseLoc(e));\n\t};\n\n\tconst clearSelection = () => {\n\t\tsetActiveStick(null);\n\t\tsetActivePoint(null);\n\t};\n\n\tconst upHandler = () => {\n\t\tupdateWork();\n\t\tclearSelection();\n\t};\n\n\tconst draw = useCallback(\n\t\t(ctx) => {\n\t\t\tctx.clearRect(0, 0, width, height);\n\t\t\tctx.beginPath();\n\t\t\tctx.lineWidth = stickWidth;\n\t\t\tctx.lineCap =\n\t\t\t\t\"round\"; /*\n\t\t\tctx.strokeStyle = \"#f5f5f5\";\n\t\t\tfor (let [initial, terminal] of startingConfiguration) {\n\t\t\t\tctx.moveTo(initial.x, initial.y);\n\t\t\t\tctx.lineTo(terminal.x, terminal.y);\n\t\t\t}*/\n\t\t\tctx.stroke();\n\t\t\tfor (let [initial, terminal] of sticks) {\n\t\t\t\tctx.beginPath();\n\t\t\t\tctx.lineWidth = stickWidth;\n\t\t\t\tctx.strokeStyle = \"#0b032d\";\n\t\t\t\tctx.moveTo(initial.x, initial.y);\n\t\t\t\tctx.lineTo(terminal.x, terminal.y);\n\t\t\t\tctx.stroke();\n\t\t\t}\n\t\t\tconst pointSelection = getPointSelection(mouseLoc) || activePoint;\n\t\t\tif (pointSelection) {\n\t\t\t\tctx.beginPath();\n\t\t\t\tctx.arc(\n\t\t\t\t\tpointSelection.x,\n\t\t\t\t\tpointSelection.y,\n\t\t\t\t\tstickWidth * 2,\n\t\t\t\t\t0,\n\t\t\t\t\t2 * Math.PI\n\t\t\t\t);\n\t\t\t\tctx.fillStyle = \"#7354f455\";\n\t\t\t\tctx.shadowBlur = stickWidth;\n\t\t\t\tctx.shadowColor = ctx.fillStyle;\n\t\t\t\tctx.fill();\n\t\t\t\tctx.shadowBlur = 0;\n\t\t\t\tctx.shadowColor = \"#0b032d\";\n\t\t\t} else {\n\t\t\t\tconst stickSelection =\n\t\t\t\t\tgetStickSelection(mouseLoc) || activeStick;\n\t\t\t\tif (stickSelection) {\n\t\t\t\t\tconst [initial, terminal] = stickSelection;\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.strokeStyle = \"#7354f455\";\n\t\t\t\t\tctx.lineWidth = stickWidth * 3;\n\t\t\t\t\tctx.moveTo(initial.x, initial.y);\n\t\t\t\t\tctx.lineTo(terminal.x, terminal.y);\n\t\t\t\t\tctx.stroke();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t[\n\t\t\tsticks,\n\t\t\theight,\n\t\t\twidth,\n\t\t\tstartingConfiguration,\n\t\t\tmouseLoc,\n\t\t\tgetPointSelection,\n\t\t\tgetStickSelection,\n\t\t\tactivePoint,\n\t\t\tactiveStick,\n\t\t\tstickWidth,\n\t\t]\n\t);\n\n\tuseEffect(() => {\n\t\tconst canvas = canvasRef.current;\n\t\tconst context = canvas.getContext(\"2d\");\n\t\tdraw(context);\n\t}, [draw]);\n\n\tuseEffect(() => {\n\t\tconst preventScroll = (e) =>\n\t\t\tactiveStick || activePoint ? e.preventDefault() : null;\n\t\tdocument.body.addEventListener(\"touchmove\", preventScroll, {\n\t\t\tpassive: false,\n\t\t});\n\t\treturn () =>\n\t\t\tdocument.body.removeEventListener(\"touchmove\", preventScroll);\n\t}, [activeStick, activePoint]);\n\n\treturn (\n\t\t<canvas\n\t\t\tid=\"mandelbrot-canvas\"\n\t\t\tref={canvasRef}\n\t\t\theight={height}\n\t\t\twidth={width}\n\t\t\tonTouchStart={touchHandler}\n\t\t\tonTouchEnd={upHandler}\n\t\t\tonTouchMove={touchDragHandler}\n\t\t\tonMouseDown={mouseDownHandler}\n\t\t\tonMouseUp={upHandler}\n\t\t\tonMouseLeave={clearSelection}\n\t\t\tonMouseMove={mouseMoveHandler}\n\t\t\tclassName={\n\t\t\t\tgetStickSelection(mouseLoc) || getPointSelection(mouseLoc)\n\t\t\t\t\t? \"selecting\"\n\t\t\t\t\t: \"\"\n\t\t\t}\n\t\t/>\n\t);\n}\n","import React, { useState } from \"react\";\nimport { useUpdateActivePuzzle, useUpdateWork } from \"../../api-utils.js\";\nimport Canvas from \"./canvas\";\n\nexport default function Instance({ name }) {\n\tconst sessionDataKey = `matchstick-instance-data-${name}`;\n\tconst data = JSON.parse(sessionStorage.getItem(sessionDataKey));\n\tconst [work, setWork] = useState(data.work);\n\tconst [saveStatus, setSaveStatus] = useState(\"saved\");\n\tconst updateWork = useUpdateWork(\"matchstick\", name, setSaveStatus);\n\n\tconst workUpdater = (newWork = work) => updateWork(newWork);\n\n\tconst reset = () => {\n\t\tconst resetWork = data.startingConfiguration.map((stick) =>\n\t\t\tstick.map((endpoint) => {\n\t\t\t\treturn { ...endpoint };\n\t\t\t})\n\t\t);\n\t\tsetWork(resetWork);\n\t\tworkUpdater(resetWork);\n\t};\n\n\tuseUpdateActivePuzzle(\"matchstick\", name);\n\n\treturn (\n\t\t<div className=\"matchstick puzzle-container\">\n\t\t\t<p className=\"description\">{data.description}</p>\n\t\t\t<div className=\"matchstick display-container\">\n\t\t\t\t<Reset reset={reset} isactive={true} />\n\t\t\t\t<Canvas\n\t\t\t\t\tpuzzleData={data}\n\t\t\t\t\tsticks={work}\n\t\t\t\t\tsetSticks={setWork}\n\t\t\t\t\tupdateWork={workUpdater}\n\t\t\t\t/>\n\t\t\t\t<div className=\"saving-indicator\">\n\t\t\t\t\t{saveStatus === \"saving\"\n\t\t\t\t\t\t? \"Saving...\"\n\t\t\t\t\t\t: saveStatus === \"error\"\n\t\t\t\t\t\t? \"An error occurred while saving.\"\n\t\t\t\t\t\t: saveStatus === \"saved\"\n\t\t\t\t\t\t? \"Saved.\"\n\t\t\t\t\t\t: \" \"}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nfunction Reset({ reset, isactive }) {\n\treturn (\n\t\t<svg\n\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\twidth=\"2048\"\n\t\t\theight=\"2048\"\n\t\t\tviewBox=\"0 0 2048 2048\"\n\t\t\tonClick={reset}\n\t\t\tclassName=\"reset nav-button\"\n\t\t\tisactive={isactive.toString()}\n\t\t>\n\t\t\t<path\n\t\t\t\td=\"M1767 1184q0 5-1 7-64 268-268 434.5t-478 166.5q-146 \n\t\t\t0-282.5-55t-243.5-157l-129 129q-19 19-45 19t-45-19-19-45v-448q0-26 \n\t\t\t19-45t45-19h448q26 0 45 19t19 45-19 45l-137 137q71 66 161 102t187 \n\t\t\t36q134 0 250-65t186-179q11-17 53-117 8-23 30-23h192q13 0 22.5 \n\t\t\t9.5t9.5 22.5zm25-800v448q0 26-19 45t-45 19h-448q-26 0-45-19t-19-45 \n\t\t\t19-45l138-138q-148-137-349-137-134 0-250 65t-186 179q-11 17-53 \n\t\t\t117-8 23-30 23h-199q-13 0-22.5-9.5t-9.5-22.5v-7q65-268 \n\t\t\t270-434.5t480-166.5q146 0 284 55.5t245 156.5l130-129q19-19 45-19t45 \n\t\t\t19 19 45z\"\n\t\t\t/>\n\t\t</svg>\n\t);\n}\n","import React, { useState, useEffect } from \"react\";\nimport Canvas from \"./canvas\";\n\nconst demoData = {\n\theight: 1024,\n\twidth: 1024,\n\tselectionProximity: 25,\n\tstickLength: 400,\n\tstickWidth: 12,\n\tstartingConfiguration: [\n\t\t[\n\t\t\t{ x: 100, y: 312 },\n\t\t\t{ x: 100, y: 712 },\n\t\t],\n\t\t[\n\t\t\t{ x: 130, y: 312 },\n\t\t\t{ x: 130, y: 712 },\n\t\t],\n\t\t[\n\t\t\t{ x: 160, y: 312 },\n\t\t\t{ x: 160, y: 712 },\n\t\t],\n\t],\n};\n\nexport default function Instructions({ history }) {\n\treturn (\n\t\t<div className=\"matchstick-instructions\">\n\t\t\t<h2>\n\t\t\t\tMatchstick Puzzle Instructions\n\t\t\t\t<hr />\n\t\t\t</h2>\n\t\t\t<div className=\"instructions\">\n\t\t\t\t<p>\n\t\t\t\t\tBefore you try the puzzles, see if you can make a triangle\n\t\t\t\t\tusing the sticks below.\n\t\t\t\t</p>\n\t\t\t\t<p>\n\t\t\t\t\tYou can move sticks by dragging them from their middle and\n\t\t\t\t\trotate sticks by dragging them from either end.\n\t\t\t\t</p>\n\t\t\t\t<p>\n\t\t\t\t\tThe button in the upper left resets the sticks to their\n\t\t\t\t\toriginal position.\n\t\t\t\t</p>\n\t\t\t\t<Instance data={demoData} />\n\t\t\t\t<p>These puzzle can be really tricky, good luck!</p>\n\t\t\t</div>\n\t\t\t<button\n\t\t\t\tclassName=\"try-it\"\n\t\t\t\tonClick={() => history.push(\"/matchstick\")}\n\t\t\t>\n\t\t\t\tTry It!\n\t\t\t</button>\n\t\t</div>\n\t);\n}\n\nfunction Instance({ data }) {\n\tconst [work, setWork] = useState(data.startingConfiguration);\n\n\tconst reset = () => {\n\t\tconst resetWork = data.startingConfiguration.map((stick) =>\n\t\t\tstick.map((endpoint) => {\n\t\t\t\treturn { ...endpoint };\n\t\t\t})\n\t\t);\n\t\tsetWork(resetWork);\n\t};\n\n\tuseEffect(reset, []);\n\n\treturn (\n\t\t<div className=\"matchstick puzzle-container\">\n\t\t\t<p className=\"description\">{data.description}</p>\n\t\t\t<div className=\"matchstick display-container\">\n\t\t\t\t<Reset reset={reset} isactive={true} />\n\t\t\t\t<Canvas\n\t\t\t\t\tpuzzleData={data}\n\t\t\t\t\tsticks={work}\n\t\t\t\t\tsetSticks={setWork}\n\t\t\t\t\tupdateWork={() => {}}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nfunction Reset({ reset, isactive }) {\n\treturn (\n\t\t<svg\n\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\twidth=\"2048\"\n\t\t\theight=\"2048\"\n\t\t\tviewBox=\"0 0 2048 2048\"\n\t\t\tonClick={reset}\n\t\t\tclassName=\"reset nav-button\"\n\t\t\tisactive={isactive.toString()}\n\t\t>\n\t\t\t<path\n\t\t\t\td=\"M1767 1184q0 5-1 7-64 268-268 434.5t-478 166.5q-146 \n\t\t\t0-282.5-55t-243.5-157l-129 129q-19 19-45 19t-45-19-19-45v-448q0-26 \n\t\t\t19-45t45-19h448q26 0 45 19t19 45-19 45l-137 137q71 66 161 102t187 \n\t\t\t36q134 0 250-65t186-179q11-17 53-117 8-23 30-23h192q13 0 22.5 \n\t\t\t9.5t9.5 22.5zm25-800v448q0 26-19 45t-45 19h-448q-26 0-45-19t-19-45 \n\t\t\t19-45l138-138q-148-137-349-137-134 0-250 65t-186 179q-11 17-53 \n\t\t\t117-8 23-30 23h-199q-13 0-22.5-9.5t-9.5-22.5v-7q65-268 \n\t\t\t270-434.5t480-166.5q146 0 284 55.5t245 156.5l130-129q19-19 45-19t45 \n\t\t\t19 19 45z\"\n\t\t\t/>\n\t\t</svg>\n\t);\n}\n","import React from \"react\";\nimport Instance from \"./instance\";\nimport Instructions from \"./instructions\";\nimport { fetchUserData } from \"../../api-utils\";\n\nconst name = \"Matchstick Puzzles\";\nconst id = \"matchstick\";\n\nfunction ListPreview() {\n\treturn <div className=\"list-preview\">Find all matchtick puzzles here</div>;\n}\n\nconst instanceList = [\n\t{ instance: \"instructions\", title: \"Instructions\" },\n\t{ instance: \"fish\", title: \"Fish\" },\n\t{ instance: \"squares1\", title: \"Squares 1\" },\n\t{ instance: \"squares2\", title: \"Squares 2\" },\n\t{ instance: \"squares3\", title: \"Squares 3\" },\n\t{ instance: \"donkey\", title: \"Donkey\" },\n\t{ instance: \"squares4\", title: \"Squares 4\" },\n\t{ instance: \"squares5\", title: \"Squares 5\" },\n];\n\ninstanceList.fetchCompletionStatus = fetchUserData;\n\nexport { name, id, ListPreview, Instance, instanceList, Instructions };\n","export default function createTangrams({ unitLength, startingCenter, work }) {\n  const positions = {\n    ...startingConfiguration({ unitLength, startingCenter }),\n    ...work,\n  };\n  return [\n    createTriangle({\n      ...positions.largeTriangle1,\n      color: \"#7d99ed\",\n      size: unitLength * 2,\n      name: \"largeTriangle1\",\n    }),\n    createTriangle({\n      ...positions.largeTriangle2,\n      color: \"#70c2df\",\n      size: unitLength * 2,\n      name: \"largeTriangle2\",\n    }),\n    createTriangle({\n      ...positions.mediumTriangle,\n      color: \"#9edfe5\",\n      size: unitLength * Math.sqrt(2),\n      name: \"mediumTriangle\",\n    }),\n    createSquare({\n      ...positions.square,\n      color: \"#c3ebef\",\n      size: unitLength,\n    }),\n    createParallelogram({\n      ...positions.parallelogram,\n      color: \"#3f2fa5\",\n      size: unitLength,\n    }),\n    createTriangle({\n      ...positions.smallTriangle1,\n      color: \"#6146d9\",\n      size: unitLength,\n      name: \"smallTriangle1\",\n    }),\n    createTriangle({\n      ...positions.smallTriangle2,\n      color: \"#7e6cfb\",\n      size: unitLength,\n      name: \"smallTriangle2\",\n    }),\n  ];\n}\n\nfunction createVertex({ shape, relAngle, distanceFromCenter }) {\n  const vertex = { relAngle };\n  Object.defineProperty(vertex, \"x\", {\n    get() {\n      return (\n        shape.center.x + Math.cos(shape.angle + relAngle) * distanceFromCenter\n      );\n    },\n  });\n  Object.defineProperty(vertex, \"y\", {\n    get() {\n      return (\n        shape.center.y + Math.sin(shape.angle + relAngle) * distanceFromCenter\n      );\n    },\n  });\n  return vertex;\n}\n\nfunction createTriangle({ size, center, angle, color, name }) {\n  const distanceToClosePoint =\n    (size * Math.sin(Math.PI / 8)) / Math.sin((5 * Math.PI) / 8);\n  const distanceToFarPoint =\n    (size * Math.sin(Math.PI / 4)) / Math.sin((5 * Math.PI) / 8);\n  const triangle = { center, color, angle, name };\n  triangle.vertices = [\n    { relAngle: 0, distanceFromCenter: distanceToClosePoint },\n    {\n      relAngle: (5 * Math.PI) / 8,\n      distanceFromCenter: distanceToFarPoint,\n    },\n    {\n      relAngle: -(5 * Math.PI) / 8,\n      distanceFromCenter: distanceToFarPoint,\n    },\n  ].map((vertex) => createVertex({ ...vertex, shape: triangle }));\n  return triangle;\n}\n\nfunction createSquare({ size, center, angle, color }) {\n  const distanceFromCenter = (size * Math.sqrt(2)) / 2;\n  const square = { center, color, angle, name: \"square\" };\n  square.vertices = Array.from({ length: 4 }, (_, i) =>\n    createVertex({\n      shape: square,\n      distanceFromCenter,\n      relAngle: (i * Math.PI) / 2,\n    })\n  );\n  return square;\n}\n\nfunction createParallelogram({ size, center, angle, color }) {\n  const distanceToClosePoint = size / 2;\n  const distanceToFarPoint = size / Math.sin(Math.atan2(2, 1));\n  const parallelogram = { center, color, angle, name: \"parallelogram\" };\n  parallelogram.vertices = [\n    { relAngle: 0, distanceFromCenter: distanceToClosePoint },\n    {\n      relAngle: -Math.atan2(2, 1),\n      distanceFromCenter: distanceToFarPoint,\n    },\n    {\n      relAngle: Math.PI,\n      distanceFromCenter: distanceToClosePoint,\n    },\n    {\n      relAngle: -(Math.PI + Math.atan2(2, 1)),\n      distanceFromCenter: distanceToFarPoint,\n    },\n  ].map((vertex) => createVertex({ ...vertex, shape: parallelogram }));\n\n  return parallelogram;\n}\n\nfunction startingConfiguration({ startingCenter, unitLength }) {\n  return {\n    largeTriangle1: {\n      center: {\n        x: startingCenter.x,\n        y:\n          startingCenter.y +\n          (unitLength * 2 * Math.sin(Math.PI / 8)) /\n            Math.sin((5 * Math.PI) / 8),\n      },\n      angle: -Math.PI / 2,\n    },\n    largeTriangle2: {\n      center: {\n        x:\n          startingCenter.x -\n          (unitLength * 2 * Math.sin(Math.PI / 8)) /\n            Math.sin((5 * Math.PI) / 8),\n        y: startingCenter.y,\n      },\n      angle: 0,\n    },\n    mediumTriangle: {\n      center: {\n        x:\n          startingCenter.x +\n          unitLength *\n            (Math.sqrt(2) -\n              Math.sin(Math.PI / 8) / Math.sin((Math.PI * 5) / 8)),\n        y:\n          startingCenter.y -\n          unitLength *\n            (Math.sqrt(2) -\n              Math.sin(Math.PI / 8) / Math.sin((Math.PI * 5) / 8)),\n      },\n      angle: -Math.PI / 4,\n    },\n    square: {\n      center: {\n        x: startingCenter.x,\n        y: startingCenter.y - (unitLength * Math.sqrt(2)) / 2,\n      },\n      angle: 0,\n    },\n    parallelogram: {\n      center: {\n        x: startingCenter.x + unitLength * ((Math.sqrt(2) * 3) / 4),\n        y: startingCenter.y + unitLength * (Math.sqrt(2) / 4),\n      },\n      angle: -Math.PI / 4,\n    },\n    smallTriangle1: {\n      center: {\n        x: startingCenter.x - (unitLength * Math.sqrt(2)) / 2,\n        y:\n          startingCenter.y -\n          unitLength *\n            (Math.sqrt(2) / 2 +\n              Math.sin(Math.PI / 8) / Math.sin((Math.PI * 5) / 8)),\n      },\n      angle: Math.PI / 2,\n    },\n    smallTriangle2: {\n      center: {\n        x:\n          startingCenter.x +\n          unitLength * (Math.sin(Math.PI / 8) / Math.sin((Math.PI * 5) / 8)),\n        y: startingCenter.y,\n      },\n      angle: Math.PI,\n    },\n  };\n}\n","export default function draw({\n\tctx,\n\twidth,\n\theight,\n\tobjective,\n\tshapes,\n\tvertexSelection,\n\tshapeSelection,\n\tobjectiveCenter,\n\tunitLength,\n}) {\n\tctx.clearRect(0, 0, width, height);\n\tobjective.forEach(\n\t\tdrawObjective.bind(null, ctx, objectiveCenter, unitLength)\n\t);\n\tshapes.forEach(drawShape.bind(null, ctx));\n\tif (vertexSelection) {\n\t\tctx.beginPath();\n\t\tctx.arc(vertexSelection.x, vertexSelection.y, 6, 0, 2 * Math.PI);\n\t\tctx.fillStyle = \"#c1b4fa\";\n\t\tctx.shadowBlur = 4;\n\t\tctx.shadowColor = ctx.fillStyle;\n\t\tctx.fill();\n\t\tctx.shadowBlur = 0;\n\t\tctx.shadowColor = \"#0b032d\";\n\t} else {\n\t\tif (shapeSelection) {\n\t\t\tdrawShape(ctx, {\n\t\t\t\t...shapeSelection,\n\t\t\t\tcolor: \"#c1b4fa\",\n\t\t\t});\n\t\t}\n\t}\n}\n\nfunction drawShape(\n\tctx,\n\t{ vertices: [firstVertex, ...vertices], color, center }\n) {\n\tctx.beginPath();\n\tctx.moveTo(firstVertex.x, firstVertex.y);\n\tvertices.forEach((point) => ctx.lineTo(point.x, point.y));\n\tctx.closePath();\n\tctx.fillStyle = color;\n\tctx.fill();\n}\n\nfunction drawObjective(ctx, objectiveCenter, unitLength, objective) {\n\tconst adjustedObjective = objective.map(([x, y]) => [\n\t\tobjectiveCenter.x + unitLength * x,\n\t\tobjectiveCenter.y + unitLength * y,\n\t]);\n\tctx.beginPath();\n\tconst [objectiveStart, ...objectivePoints] = adjustedObjective;\n\tctx.moveTo(...objectiveStart);\n\tobjectivePoints.forEach((point) => ctx.lineTo(...point));\n\tctx.closePath();\n\tctx.fillStyle = \"#0b032d\";\n\tctx.fill();\n}\n","import React, {\n\tuseState,\n\tuseEffect,\n\tuseRef,\n\tuseCallback,\n\tuseMemo,\n} from \"react\";\nimport createTangrams from \"./model\";\nimport {\n\tdistanceFromPoint,\n\tonSameSide,\n\tdifference,\n\tsum,\n} from \"../vector-logic\";\nimport draw from \"./view\";\n\nexport default function Controller({ data, work, updateWork, saveStatus }) {\n\tconst canvasRef = useRef(null);\n\tconst {\n\t\theight,\n\t\twidth,\n\t\tselectionProximity,\n\t\tunitLength,\n\t\tobjective,\n\t\tstartingCenter,\n\t\tobjectiveCenter,\n\t} = useMemo(() => data, [data]);\n\tconst [activeVertex, setActiveVertex] = useState(null);\n\tconst [activeShape, setActiveShape] = useState(null);\n\tconst [mouseLoc, setMouseLoc] = useState({ x: 0, y: 0 });\n\tconst [shapes, setShapes] = useState(\n\t\tcreateTangrams({ unitLength, startingCenter, work })\n\t);\n\n\tconst getMouseLoc = (e, locationObject = e) => {\n\t\tconst rect = e.target.getBoundingClientRect();\n\t\tconst mouseLocation = {\n\t\t\tx: ((locationObject.clientX - rect.left) / rect.width) * width,\n\t\t\ty: ((locationObject.clientY - rect.top) / rect.height) * height,\n\t\t};\n\t\tsetMouseLoc(mouseLocation);\n\t\treturn mouseLocation;\n\t};\n\n\tconst getVertexSelection = useCallback(\n\t\t(mouseLocation) => {\n\t\t\tif (activeShape) return;\n\t\t\tconst points = shapes.flatMap((shape) => shape.vertices);\n\t\t\treturn (\n\t\t\t\tactiveVertex ||\n\t\t\t\tpoints.reduce(\n\t\t\t\t\t(acc, point) => {\n\t\t\t\t\t\tconst distance = distanceFromPoint(\n\t\t\t\t\t\t\tpoint,\n\t\t\t\t\t\t\tmouseLocation\n\t\t\t\t\t\t);\n\t\t\t\t\t\tconst accDistance = acc\n\t\t\t\t\t\t\t? distanceFromPoint(mouseLocation, acc)\n\t\t\t\t\t\t\t: Infinity;\n\t\t\t\t\t\treturn distance <\n\t\t\t\t\t\t\tMath.min(accDistance, selectionProximity)\n\t\t\t\t\t\t\t? point\n\t\t\t\t\t\t\t: acc;\n\t\t\t\t\t},\n\n\t\t\t\t\tnull\n\t\t\t\t)\n\t\t\t);\n\t\t},\n\t\t[shapes, activeVertex, activeShape, selectionProximity]\n\t);\n\n\tconst getShapeSelection = useCallback(\n\t\t(mouseLocation) =>\n\t\t\tactiveShape ||\n\t\t\tshapes.reduce(\n\t\t\t\t(acc, shape) =>\n\t\t\t\t\tisInsideShape({ shape, point: mouseLocation })\n\t\t\t\t\t\t? shape\n\t\t\t\t\t\t: acc,\n\t\t\t\tnull\n\t\t\t),\n\t\t[shapes, activeShape]\n\t);\n\n\tconst selectPoint = (mouseLocation) => {\n\t\tconst selectedPoint = getVertexSelection(mouseLocation);\n\t\tif (selectedPoint) {\n\t\t\tconst selectedShape = shapes.find(({ vertices }) =>\n\t\t\t\tvertices.includes(selectedPoint)\n\t\t\t);\n\t\t\tsetActiveVertex(selectedPoint);\n\t\t\tsetActiveShape(selectedShape);\n\t\t\treturn selectedPoint;\n\t\t}\n\t};\n\n\tconst selectStick = (mouseLocation) => {\n\t\tconst selectedShape = getShapeSelection(mouseLocation);\n\t\tsetActiveShape(selectedShape);\n\t\treturn selectedShape;\n\t};\n\n\tconst select = (mouseLocation) => {\n\t\tconst selectedPoint = selectPoint(mouseLocation);\n\t\tif (!selectedPoint) {\n\t\t\tselectStick(mouseLocation);\n\t\t}\n\t};\n\n\tconst mouseShapeDrag = (e) => {\n\t\tif (!activeVertex && activeShape) {\n\t\t\tconst rect = e.target.getBoundingClientRect();\n\t\t\tconst center = activeShape.center;\n\t\t\tactiveShape.center = {\n\t\t\t\tx: center.x + (e.movementX * width) / rect.width,\n\t\t\t\ty: center.y + (e.movementY * height) / rect.height,\n\t\t\t};\n\t\t\tsetShapes([...shapes]);\n\t\t}\n\t};\n\n\tconst touchShapeDrag = (touchLocation) => {\n\t\tif (!activeVertex && activeShape) {\n\t\t\tactiveShape.center = touchLocation;\n\t\t\tsetShapes([...shapes]);\n\t\t}\n\t};\n\n\tconst pointDrag = (mouseLocation) => {\n\t\tif (activeVertex) {\n\t\t\tconst { vertices, center } = activeShape;\n\t\t\tconst vertexIndex = vertices.indexOf(activeVertex);\n\t\t\tconst relVertex = vertices[(vertexIndex + 1) % vertices.length];\n\t\t\tconst fixedRelVertex = { x: relVertex.x, y: relVertex.y };\n\t\t\tconst relVector = difference(activeVertex, relVertex);\n\t\t\tconst startVector = difference(vertices[0], center);\n\t\t\tconst angleDifference =\n\t\t\t\tMath.atan2(relVector.y, relVector.x) -\n\t\t\t\tMath.atan2(startVector.y, startVector.x);\n\t\t\tconst relMouse = difference(mouseLocation, relVertex);\n\t\t\tconst mouseAngle = Math.atan2(relMouse.y, relMouse.x);\n\t\t\tactiveShape.angle = mouseAngle - angleDifference;\n\t\t\tactiveShape.center = sum(\n\t\t\t\tfixedRelVertex,\n\t\t\t\tdifference(center, relVertex)\n\t\t\t);\n\t\t\tsetShapes([...shapes]);\n\t\t}\n\t};\n\n\tconst snapShape = () => {\n\t\tif (activeVertex) {\n\t\t\tconst { vertices, center } = activeShape;\n\t\t\tconst vertexIndex = vertices.indexOf(activeVertex);\n\t\t\tconst relVertex = vertices[(vertexIndex + 1) % vertices.length];\n\t\t\tconst fixedRelVertex = { x: relVertex.x, y: relVertex.y };\n\t\t\tconst relVector = difference(activeVertex, relVertex);\n\t\t\tconst startVector = difference(vertices[0], center);\n\t\t\tconst angleDifference =\n\t\t\t\tMath.atan2(relVector.y, relVector.x) -\n\t\t\t\tMath.atan2(startVector.y, startVector.x);\n\t\t\tconst snapAngle = Math.atan2(relVector.y, relVector.x);\n\t\t\tconst snappedAngle = Array.from(\n\t\t\t\t{ length: 25 },\n\t\t\t\t(...[, i]) => (Math.PI * i) / 12 - Math.PI\n\t\t\t).find((angle) => Math.abs(snapAngle - angle) <= Math.PI / 23);\n\t\t\tactiveShape.angle = snappedAngle - angleDifference;\n\t\t\tactiveShape.center = sum(\n\t\t\t\tfixedRelVertex,\n\t\t\t\tdifference(center, relVertex)\n\t\t\t);\n\t\t\tsetShapes([...shapes]);\n\t\t}\n\t};\n\n\tconst reset = () => {\n\t\tconst startingPosition = createTangrams({\n\t\t\tunitLength,\n\t\t\tstartingCenter,\n\t\t\twork: {},\n\t\t});\n\t\tsetShapes(startingPosition);\n\t\tupdateWork(startingPosition);\n\t};\n\n\tconst clearSelection = () => {\n\t\tsetActiveShape(null);\n\t\tsetActiveVertex(null);\n\t};\n\n\tconst upHandler = () => {\n\t\tsnapShape();\n\t\tupdateWork(shapes);\n\t\tclearSelection();\n\t};\n\n\tconst mouseMoveHandler = (e) => {\n\t\tconst mouseLocation = getMouseLoc(e);\n\t\tpointDrag(mouseLocation);\n\t\tmouseShapeDrag(e);\n\t};\n\n\tconst mouseDownHandler = (e) => {\n\t\tselect(getMouseLoc(e));\n\t};\n\n\tconst touchHandler = (e) => {\n\t\tconst touch = e.touches[0];\n\t\tconst touchLocation = getMouseLoc(e, touch);\n\t\tselect(touchLocation);\n\t};\n\n\tconst touchDragHandler = (e) => {\n\t\tconst touch = e.touches[0];\n\t\tconst touchLocation = getMouseLoc(e, touch);\n\t\tpointDrag(touchLocation);\n\t\ttouchShapeDrag(touchLocation);\n\t};\n\n\tuseEffect(() => {\n\t\tconst canvas = canvasRef.current;\n\t\tconst ctx = canvas.getContext(\"2d\");\n\t\tdraw({\n\t\t\tctx,\n\t\t\tshapeSelection: activeShape || getShapeSelection(mouseLoc),\n\t\t\tvertexSelection: activeVertex || getVertexSelection(mouseLoc),\n\t\t\theight,\n\t\t\twidth,\n\t\t\tshapes,\n\t\t\tobjective,\n\t\t\tobjectiveCenter,\n\t\t\tunitLength,\n\t\t});\n\t}, [\n\t\tactiveShape,\n\t\tgetShapeSelection,\n\t\tactiveVertex,\n\t\tgetVertexSelection,\n\t\theight,\n\t\twidth,\n\t\tshapes,\n\t\tobjective,\n\t\tmouseLoc,\n\t\tobjectiveCenter,\n\t\tunitLength,\n\t]);\n\n\tuseEffect(() => {\n\t\tconst preventScroll = (e) =>\n\t\t\tactiveShape || activeVertex ? e.preventDefault() : null;\n\t\tconst canvas = document.querySelector(\"canvas\");\n\t\tcanvas.addEventListener(\"touchmove\", preventScroll, {\n\t\t\tpassive: false,\n\t\t});\n\t\treturn () => canvas.removeEventListener(\"touchmove\", preventScroll);\n\t}, [activeVertex, activeShape]);\n\n\treturn (\n\t\t<div className=\"tangram display-container\">\n\t\t\t<Reset reset={reset} isactive={true} />\n\t\t\t<canvas\n\t\t\t\tid=\"tangram-canvas\"\n\t\t\t\tref={canvasRef}\n\t\t\t\theight={height}\n\t\t\t\twidth={width}\n\t\t\t\tonMouseDown={mouseDownHandler}\n\t\t\t\tonMouseUp={upHandler}\n\t\t\t\tonMouseLeave={clearSelection}\n\t\t\t\tonMouseMove={mouseMoveHandler}\n\t\t\t\tonTouchStart={touchHandler}\n\t\t\t\tonTouchEnd={upHandler}\n\t\t\t\tonTouchMove={touchDragHandler}\n\t\t\t\tclassName={\n\t\t\t\t\tgetShapeSelection(mouseLoc) || getVertexSelection(mouseLoc)\n\t\t\t\t\t\t? \"selecting\"\n\t\t\t\t\t\t: \"\"\n\t\t\t\t}\n\t\t\t/>\n\t\t\t<div className=\"saving-indicator\">\n\t\t\t\t{saveStatus === \"saving\"\n\t\t\t\t\t? \"Saving...\"\n\t\t\t\t\t: saveStatus === \"error\"\n\t\t\t\t\t? \"An error occurred while saving.\"\n\t\t\t\t\t: saveStatus === \"saved\"\n\t\t\t\t\t? \"Saved.\"\n\t\t\t\t\t: \" \"}\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nfunction Reset({ reset, isactive }) {\n\treturn (\n\t\t<svg\n\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\twidth=\"2048\"\n\t\t\theight=\"2048\"\n\t\t\tviewBox=\"0 0 2048 2048\"\n\t\t\tonClick={reset}\n\t\t\tclassName=\"reset nav-button\"\n\t\t\tisactive={isactive.toString()}\n\t\t>\n\t\t\t<path\n\t\t\t\td=\"M1767 1184q0 5-1 7-64 268-268 434.5t-478 166.5q-146 \n      0-282.5-55t-243.5-157l-129 129q-19 19-45 19t-45-19-19-45v-448q0-26 \n      19-45t45-19h448q26 0 45 19t19 45-19 45l-137 137q71 66 161 102t187 \n      36q134 0 250-65t186-179q11-17 53-117 8-23 30-23h192q13 0 22.5 \n      9.5t9.5 22.5zm25-800v448q0 26-19 45t-45 19h-448q-26 0-45-19t-19-45 \n      19-45l138-138q-148-137-349-137-134 0-250 65t-186 179q-11 17-53 \n      117-8 23-30 23h-199q-13 0-22.5-9.5t-9.5-22.5v-7q65-268 \n      270-434.5t480-166.5q146 0 284 55.5t245 156.5l130-129q19-19 45-19t45 \n      19 19 45z\"\n\t\t\t/>\n\t\t</svg>\n\t);\n}\n\nfunction isInsideShape({ shape: { vertices, center }, point }) {\n\treturn vertices.every((vertex, index, vertices) => {\n\t\tconst adjacentVertex = vertices[(index + 1) % vertices.length];\n\t\tconst segment = [\n\t\t\t{ x: vertex.x, y: vertex.y },\n\t\t\t{ x: adjacentVertex.x, y: adjacentVertex.y },\n\t\t];\n\t\treturn onSameSide(point, center, segment);\n\t});\n}\n","import React, { useState } from \"react\";\nimport { useUpdateActivePuzzle, useUpdateWork } from \"../../api-utils.js\";\nimport Controller from \"./controller\";\n\nexport default function Instance({name}) {\n\tconst sessionDataKey = `tangram-instance-data-${name}`;\n\tconst data = JSON.parse(sessionStorage.getItem(sessionDataKey));\n\tconst [work, setWork] = useState(data.work);\n\tconst [saveStatus, setSaveStatus] = useState(\"saved\");\n\tconst updateWork = useUpdateWork(\"tangram\", name, setSaveStatus);\n\n\tconst workUpdater = (shapes) => {\n\t\tconst newWork = { ...work };\n\t\tfor (let shape of shapes) {\n\t\t\tconst { name, center, angle } = shape;\n\t\t\tnewWork[name] = { center, angle };\n\t\t}\n\t\tsetWork(newWork);\n\t\tupdateWork(newWork);\n\t};\n\n\tuseUpdateActivePuzzle(\"tangram\", name);\n\n\treturn (\n\t\t<div className=\"tangram puzzle-container\">\n\t\t\t<p className=\"description\">{data.description}</p>\n\t\t\t<Controller\n\t\t\t\tdata={data}\n\t\t\t\twork={work}\n\t\t\t\tupdateWork={workUpdater}\n\t\t\t\tsaveStatus={saveStatus}\n\t\t\t/>\n\t\t</div>\n\t);\n}\n","const height = 768;\nconst width = 1024;\nconst unitLength = 100;\nconst selectionProximity = 20;\nconst objectiveCenter = { x: 300, y: 384 };\nconst startingCenter = { x: 768, y: 384 };\nconst triangle = [\n\t[-2 * Math.sqrt(2), +Math.sqrt(2)],\n\t[2 * Math.sqrt(2), +Math.sqrt(2)],\n\t[0, -Math.sqrt(2)],\n];\nconst square = [\n\t[-Math.sqrt(2), -Math.sqrt(2)],\n\t[Math.sqrt(2), -Math.sqrt(2)],\n\t[Math.sqrt(2), Math.sqrt(2)],\n\t[-Math.sqrt(2), Math.sqrt(2)],\n];\n\nconst defaultData = {\n\tobjective: [square],\n\tstartingCenter,\n\tunitLength,\n\theight,\n\twidth,\n\tselectionProximity,\n\tobjectiveCenter,\n\twork: {},\n};\n\nexport { defaultData };\n","import React from \"react\";\nimport Controller from \"./controller\";\nimport { defaultData } from \"./sample-data\";\n\nexport default function Instructions({ history }) {\n\treturn (\n\t\t<div className=\"tangram tangram-instructions\">\n\t\t\t<h2>\n\t\t\t\tTangram Instructions\n\t\t\t\t<hr />\n\t\t\t</h2>\n\t\t\t<p className=\"instructions\">\n\t\t\t\tIn tangram puzzles you will be given the same pieces each time\n\t\t\t\tand be tasked with making different shapes out of them! To move\n\t\t\t\ta piece, simply drag it. And to rotate a piece drag one of its\n\t\t\t\tcorners.\n\t\t\t</p>\n\t\t\t<Controller data={defaultData} work={{}} updateWork={() => {}} />\n\t\t\t<button className=\"try-it\" onClick={() => history.push(\"/tangram\")}>\n\t\t\t\tTry It!\n\t\t\t</button>\n\t\t</div>\n\t);\n}\n","import React from \"react\";\nimport Instance from \"./instance\";\nimport Instructions from \"./instructions\";\nimport { fetchUserData } from \"../../api-utils\";\n\nconst name = \"Tangrams\";\nconst id = \"tangram\";\n\nfunction ListPreview() {\n\treturn <div className=\"list-preview\">Find all tangram puzzles here</div>;\n}\n\nconst instanceList = [\n\t{ instance: \"instructions\", title: \"Instructions\" },\n\t{ instance: \"triangle\", title: \"Triangle\" },\n\t{ instance: \"rectangle\", title: \"Rectangle\" },\n\t{ instance: \"trapezoid\", title: \"Trapezoid\" },\n\t{ instance: \"twotriangles\", title: \"Two Triangles\" },\n\t{ instance: \"twosquares\", title: \"Two Squares\" },\n\t{ instance: \"cube\", title: \"Cube\" },\n\t{ instance: \"hexagon\", title: \"Hexagon\" },\n\t{ instance: \"incompleterectangle\", title: \"Incomplete Rectangle\" },\n];\n\ninstanceList.fetchCompletionStatus = fetchUserData;\n\nexport { name, id, ListPreview, Instance, instanceList, Instructions };\n","//import * as Test from \"./test/index\";\nimport * as calcudoku from \"./calcudoku/index\";\nimport * as logic from \"./logic/index\";\nimport * as light from \"./light/index\";\nimport * as matchstick from \"./matchstick/index\";\nimport * as tangram from \"./tangram/index\";\n\nexport const puzzleList = [logic, calcudoku, light, matchstick, tangram];\n\nexport const potd = {\n\turi: \"/\",\n\tPreview: POTDPreview,\n};\n\nfunction POTDPreview() {\n\treturn <div className=\"potd-preview\">Check back later!</div>;\n}\n","import React, { useContext } from \"react\";\nimport { potd, puzzleList } from \"../puzzles/index\";\nimport { UserContext } from \"../login/user-context.js\";\n\nexport default function Home({ history }) {\n\tconst {\n\t\tuser: { token },\n\t} = useContext(UserContext);\n\treturn (\n\t\t<div className=\"dashboard-container\">\n\t\t\t<POTD history={history} token={token} />\n\t\t\t<div className=\"puzzle-list-container\">\n\t\t\t\t<h2>Individual Work</h2>\n\t\t\t\t<ul>\n\t\t\t\t\t{puzzleList.map(\n\t\t\t\t\t\trenderPuzzleListing.bind(null, history, token)\n\t\t\t\t\t)}\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nfunction POTD(props) {\n\tconst POTDPreview = potd.Preview;\n\treturn (\n\t\t<div\n\t\t\tclassName=\"potd-container\"\n\t\t\tonClick={() => props.history.push(potd.uri, { token: props.token })}\n\t\t>\n\t\t\t<h2>Puzzle of the Day</h2>\n\t\t\t<POTDPreview />\n\t\t</div>\n\t);\n}\n\nfunction renderPuzzleListing(history, token, puzzle) {\n\treturn (\n\t\t<li\n\t\t\tkey={puzzle.id}\n\t\t\tonClick={() => history.push(`/${puzzle.id}`, { token })}\n\t\t>\n\t\t\t<h3>{puzzle.name}</h3>\n\t\t\t{puzzle.ListPreview()}\n\t\t</li>\n\t);\n}\n","import React, { useState, useEffect, useContext } from \"react\";\nimport { UserContext } from \"../login/user-context\";\n\nexport default function List({ history, instanceList, title, puzzleType }) {\n\tconst { user } = useContext(UserContext);\n\tconst [completionStatusFetched, setCompletionStatusFetched] = useState(\n\t\tfalse\n\t);\n\n\tuseEffect(() => {\n\t\tif (!completionStatusFetched) {\n\t\t\t(async () => {\n\t\t\t\tawait instanceList.fetchCompletionStatus(user);\n\t\t\t\tsetCompletionStatusFetched(true);\n\t\t\t})();\n\t\t}\n\t}, [completionStatusFetched, instanceList, user]);\n\n\tconst renderInstanceListing = (history, { instance, title }) => {\n\t\tconst sessionDataKey = `${puzzleType}-instance-data-${instance}`;\n\t\tconst sessionData = JSON.parse(sessionStorage.getItem(sessionDataKey));\n\t\tconst completed = sessionData ? sessionData.completed : false;\n\n\t\treturn (\n\t\t\t<li\n\t\t\t\tkey={instance}\n\t\t\t\tonClick={() => history.push(`/${puzzleType}/${instance}`)}\n\t\t\t\tclassName={completed ? \"completed\" : \"\"}\n\t\t\t>\n\t\t\t\t<h3>{capitalize(title)}</h3>\n\t\t\t</li>\n\t\t);\n\t};\n\n\treturn (\n\t\t<div className=\"instance-list-container\">\n\t\t\t<h2>{title}</h2>\n\t\t\t<ul\n\t\t\t\tstyle={{\n\t\t\t\t\t\"grid-template-rows\": `repeat(${Math.ceil(\n\t\t\t\t\t\tinstanceList.length / 2\n\t\t\t\t\t)}, 1fr)`,\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{instanceList.map(renderInstanceListing.bind(null, history))}\n\t\t\t</ul>\n\t\t</div>\n\t);\n}\n\nfunction capitalize(string) {\n\treturn string.replace(/^./, (char) => char.toUpperCase());\n}\n","import React from \"react\";\nimport { Route, Switch } from \"react-router-dom\";\nimport List from \"./instance-list\";\n\nexport default function InstanceRouter(props) {\n\tconst { match, Instance, Instructions, id, name, instanceList } = props;\n\n\tconst renderInstanceRoute = (match, { instance }) => {\n\t\treturn (\n\t\t\t<Route\n\t\t\t\tkey={instance}\n\t\t\t\tpath={`${match.url}/${instance}`}\n\t\t\t\trender={(props) => <Instance {...props} name={instance} />}\n\t\t\t/>\n\t\t);\n\t};\n\n\treturn (\n\t\t<Switch>\n\t\t\t<Route\n\t\t\t\tkey=\"instructions\"\n\t\t\t\tpath={`${match.url}/instructions`}\n\t\t\t\trender={(props) => <Instructions {...props} />}\n\t\t\t/>\n\t\t\t{instanceList.map(renderInstanceRoute.bind(null, match))}\n\t\t\t<Route\n\t\t\t\texact\n\t\t\t\tpath={match.url}\n\t\t\t\trender={(props) => (\n\t\t\t\t\t<List\n\t\t\t\t\t\t{...props}\n\t\t\t\t\t\tinstanceList={instanceList}\n\t\t\t\t\t\ttitle={name}\n\t\t\t\t\t\tpuzzleType={id}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t/>\n\t\t</Switch>\n\t);\n}\n","import React, { useState, useEffect } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { HashRouter, Switch, Route, Redirect } from \"react-router-dom\";\nimport { createBrowserHistory } from \"history\";\n\nimport Login from \"./login/index\";\nimport { UserContext } from \"./login/user-context\";\nimport Home from \"./home/index\";\nimport { puzzleList } from \"./puzzles/index\";\nimport InstanceRouter from \"./puzzles/instance-router\";\nimport { fetchUserData } from \"./api-utils\"\n\nimport \"./stylesheets/index.css\";\n\nconst history = createBrowserHistory();\n\nconst backArrowPath = (\n\t<path\n\t\td={\n\t\t\t\"M1792 1024v128q0 53-32.5 90.5t-84.5 37.5h-704l293 294q38 36 \" +\n\t\t\t\"38 90t-38 90l-75 76q-37 37-90 37-52 0-91-37l-651-652q-37-37-\" +\n\t\t\t\"37-90 0-52 37-91l651-650q38-38 91-38 52 0 90 38l75 74q38 38 \" +\n\t\t\t\"38 91t-38 91l-293 293h704q52 0 84.5 37.5t32.5 90.5z\"\n\t\t}\n\t/>\n);\n\nfunction Routes() {\n\tconst sessionUser = JSON.parse(sessionStorage.getItem(\"mcub-student-user\"));\n\tconst [user, setUser] = useState(sessionUser);\n\tconst defaultContext = {\n\t\tuser,\n\t\tsetUser,\n\t};\n\n\tuseEffect(() => {\n\t\tif (user) {\n\t\t\t(async () => {\n\t\t\t\ttry {\n\t\t\t\t\tawait fetchUserData(user);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t}\n\t\t\t})();\n\t\t}\n\t}, [user]);\n\n\treturn (\n\t\t<HashRouter history={history} basename=\"/\">\n\t\t\t<UserContext.Provider value={defaultContext}>\n\t\t\t\t{user ? (\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<nav className=\"main-nav\">\n\t\t\t\t\t\t\t<ProfileBar\n\t\t\t\t\t\t\t\tstudent={user.student}\n\t\t\t\t\t\t\t\tsetUser={setUser}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Switch>\n\t\t\t\t\t\t\t\t<Route exact path=\"/\" />\n\t\t\t\t\t\t\t\t<Route component={BackButton} />\n\t\t\t\t\t\t\t</Switch>\n\t\t\t\t\t\t</nav>\n\n\t\t\t\t\t\t<Switch>\n\t\t\t\t\t\t\t{puzzleList.map(renderPuzzleRoute)}\n\t\t\t\t\t\t\t<Route path=\"/login\" component={Login} />\n\t\t\t\t\t\t\t<Route path=\"/\" component={Home} />\n\t\t\t\t\t\t</Switch>\n\t\t\t\t\t</div>\n\t\t\t\t) : (\n\t\t\t\t\t<Switch>\n\t\t\t\t\t\t<Route path=\"/login\" component={Login} />\n\t\t\t\t\t\t<Route path=\"/\">\n\t\t\t\t\t\t\t<Redirect to=\"/login\" />\n\t\t\t\t\t\t</Route>\n\t\t\t\t\t</Switch>\n\t\t\t\t)}\n\t\t\t</UserContext.Provider>\n\t\t</HashRouter>\n\t);\n}\n\nfunction BackButton({ history }) {\n\tconst prevURL = window.location.href.match(/#(.*)\\/[^/]+$/)[1];\n\treturn (\n\t\t<svg\n\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\twidth=\"2048\"\n\t\t\theight=\"2048\"\n\t\t\tviewBox=\"0 0 2048 2048\"\n\t\t\tonClick={() => history.push(prevURL)}\n\t\t\tclassName=\"back-button\"\n\t\t>\n\t\t\t{backArrowPath}\n\t\t</svg>\n\t);\n}\n\nfunction ProfileBar({ student, setUser }) {\n\treturn (\n\t\t<div className=\"profile-bar\">\n\t\t\t<span className=\"student-name\">\n\t\t\t\t{capitalize(student.first)} {capitalize(student.last)}\n\t\t\t</span>\n\t\t\t<button\n\t\t\t\tonClick={() => {\n\t\t\t\t\tsetUser(null);\n\t\t\t\t\tsessionStorage.removeItem(\"mcub-student-user\");\n\t\t\t\t}}\n\t\t\t\tclassName=\"log-out\"\n\t\t\t>\n\t\t\t\tLog Out\n\t\t\t</button>\n\t\t</div>\n\t);\n}\n\nfunction renderPuzzleRoute(puzzle) {\n\tconst { Instance, id, Instructions, name, instanceList } = puzzle;\n\treturn (\n\t\t<Route\n\t\t\tkey={puzzle.id}\n\t\t\tpath={`/${puzzle.id}`}\n\t\t\trender={(props) => (\n\t\t\t\t<InstanceRouter\n\t\t\t\t\t{...props}\n\t\t\t\t\tInstance={Instance}\n\t\t\t\t\tid={id}\n\t\t\t\t\tInstructions={Instructions}\n\t\t\t\t\tname={name}\n\t\t\t\t\tinstanceList={instanceList}\n\t\t\t\t/>\n\t\t\t)}\n\t\t/>\n\t);\n}\n\nfunction capitalize(string) {\n\treturn string.replace(/^.|\\W./g, (char) => char.toUpperCase());\n}\n\n//---------\n\nReactDOM.render(\n\t<React.StrictMode>\n\t\t<Routes />\n\t</React.StrictMode>,\n\tdocument.getElementById(\"root\")\n);\n"],"sourceRoot":""}